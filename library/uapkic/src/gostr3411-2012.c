/*
 * Copyright 2021 The UAPKI Project Authors.
 * 
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions are 
 * met:
 * 
 * 1. Redistributions of source code must retain the above copyright 
 * notice, this list of conditions and the following disclaimer.
 * 
 * 2. Redistributions in binary form must reproduce the above copyright 
 * notice, this list of conditions and the following disclaimer in the 
 * documentation and/or other materials provided with the distribution.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS 
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED 
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A 
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED 
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF 
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING 
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#define FILE_MARKER "uapkic/gostr3411-2012.c"

#include <string.h>
#include <stddef.h>

#include "gostr3411-2012.h"
#include "byte-utils-internal.h"
#include "byte-array-internal.h"
#include "macros-internal.h"

struct GostR3411Ctx_st
{
    uint64_t state[8];
    uint64_t total_length[8];
    uint64_t sigma[8];
    uint8_t block[64];
    size_t block_ind;
    GostR3411Variant variant;
};

#define LE_READ_UINT64(p)			\
(  (((uint64_t) (p)[7]) << 56)			\
 | (((uint64_t) (p)[6]) << 48)			\
 | (((uint64_t) (p)[5]) << 40)			\
 | (((uint64_t) (p)[4]) << 32)			\
 | (((uint64_t) (p)[3]) << 24)			\
 | (((uint64_t) (p)[2]) << 16)			\
 | (((uint64_t) (p)[1]) << 8)			\
 |  ((uint64_t) (p)[0]))

#define LE_WRITE_UINT64(p, i)			\
  (p)[7] = ((i) >> 56) & 0xff;			\
  (p)[6] = ((i) >> 48) & 0xff;			\
  (p)[5] = ((i) >> 40) & 0xff;			\
  (p)[4] = ((i) >> 32) & 0xff;			\
  (p)[3] = ((i) >> 24) & 0xff;			\
  (p)[2] = ((i) >> 16) & 0xff;			\
  (p)[1] = ((i) >> 8) & 0xff;			\
  (p)[0] = (i) & 0xff

static const uint64_t gostr3411_2012_ext_table[8][256] = {
{ 
    0xD01F715B5C7EF8E6ULL, 0x16FA240980778325ULL, 0xA8A42E857EE049C8ULL, 0x6AC1068FA186465BULL,
    0x6E417BD7A2E9320BULL, 0x665C8167A437DAABULL, 0x7666681AA89617F6ULL, 0x4B959163700BDCF5ULL,
    0xF14BE6B78DF36248ULL, 0xC585BD689A625CFFULL, 0x9557D7FCA67D82CBULL, 0x89F0B969AF6DD366ULL,
    0xB0833D48749F6C35ULL, 0xA1998C23B1ECBC7CULL, 0x8D70C431AC02A736ULL, 0xD6DFBC2FD0A8B69EULL,
    0x37AEB3E551FA198BULL, 0x0B7D128A40B5CF9CULL, 0x5A8F2008B5780CBCULL, 0xEDEC882284E333E5ULL,
    0xD25FC177D3C7C2CEULL, 0x5E0F5D50B61778ECULL, 0x1D873683C0C24CB9ULL, 0xAD040BCBB45D208CULL,
    0x2F89A0285B853C76ULL, 0x5732FFF6791B8D58ULL, 0x3E9311439EF6EC3FULL, 0xC9183A809FD3C00FULL,
    0x83ADF3F5260A01EEULL, 0xA6791941F4E8EF10ULL, 0x103AE97D0CA1CD5DULL, 0x2CE948121DEE1B4AULL,
    0x39738421DBF2BF53ULL, 0x093DA2A6CF0CF5B4ULL, 0xCD9847D89CBCB45FULL, 0xF9561C078B2D8AE8ULL,
    0x9C6A755A6971777FULL, 0xBC1EBAA0712EF0C5ULL, 0x72E61542ABF963A6ULL, 0x78BB5FDE229EB12EULL,
    0x14BA94250FCEB90DULL, 0x844D6697630E5282ULL, 0x98EA08026A1E032FULL, 0xF06BBEA144217F5CULL,
    0xDB6263D11CCB377AULL, 0x641C314B2B8EE083ULL, 0x320E96AB9B4770CFULL, 0x1EE7DEB986A96B85ULL,
    0xE96CF57A878C47B5ULL, 0xFDD6615F8842FEB8ULL, 0xC83862965601DD1BULL, 0x2EA9F83E92572162ULL,
    0xF876441142FF97FCULL, 0xEB2C455608357D9DULL, 0x5612A7E0B0C9904CULL, 0x6C01CBFB2D500823ULL,
    0x4548A6A7FA037A2DULL, 0xABC4C6BF388B6EF4ULL, 0xBADE77D4FDF8BEBDULL, 0x799B07C8EB4CAC3AULL,
    0x0C9D87E805B19CF0ULL, 0xCB588AAC106AFA27ULL, 0xEA0C1D40C1E76089ULL, 0x2869354A1E816F1AULL,
    0xFF96D17307FBC490ULL, 0x9F0A9D602F1A5043ULL, 0x96373FC6E016A5F7ULL, 0x5292DAB8B3A6E41CULL,
    0x9B8AE0382C752413ULL, 0x4F15EC3B7364A8A5ULL, 0x3FB349555724F12BULL, 0xC7C50D4415DB66D7ULL,
    0x92B7429EE379D1A7ULL, 0xD37F99611A15DFDAULL, 0x231427C05E34A086ULL, 0xA439A96D7B51D538ULL,
    0xB403401077F01865ULL, 0xDDA2AEA5901D7902ULL, 0x0A5D4A9C8967D288ULL, 0xC265280ADF660F93ULL,
    0x8BB0094520D4E94EULL, 0x2A29856691385532ULL, 0x42A833C5BF072941ULL, 0x73C64D54622B7EB2ULL,
    0x07E095624504536CULL, 0x8A905153E906F45AULL, 0x6F6123C16B3B2F1FULL, 0xC6E55552DC097BC3ULL,
    0x4468FEB133D16739ULL, 0xE211E7F0C7398829ULL, 0xA2F96419F7879B40ULL, 0x19074BDBC3AD38E9ULL,
    0xF4EBC3F9474E0B0CULL, 0x43886BD376D53455ULL, 0xD8028BEB5AA01046ULL, 0x51F23282F5CDC320ULL,
    0xE7B1C2BE0D84E16DULL, 0x081DFAB006DEE8A0ULL, 0x3B33340D544B857BULL, 0x7F5BCABC679AE242ULL,
    0x0EDD37C48A08A6D8ULL, 0x81ED43D9A9B33BC6ULL, 0xB1A3655EBD4D7121ULL, 0x69A1EEB5E7ED6167ULL,
    0xF6AB73D5C8F73124ULL, 0x1A67A3E185C61FD5ULL, 0x2DC91004D43C065EULL, 0x0240B02C8FB93A28ULL,
    0x90F7F2B26CC0EB8FULL, 0x3CD3A16F114FD617ULL, 0xAAE49EA9F15973E0ULL, 0x06C0CD748CD64E78ULL,
    0xDA423BC7D5192A6EULL, 0xC345701C16B41287ULL, 0x6D2193EDE4821537ULL, 0xFCF639494190E3ACULL,
    0x7C3B228621F1C57EULL, 0xFB16AC2B0494B0C0ULL, 0xBF7E529A3745D7F9ULL, 0x6881B6A32E3F7C73ULL,
    0xCA78D2BAD9B8E733ULL, 0xBBFE2FC2342AA3A9ULL, 0x0DBDDFFECC6381E4ULL, 0x70A6A56E2440598EULL,
    0xE4D12A844BEFC651ULL, 0x8C509C2765D0BA22ULL, 0xEE8C6018C28814D9ULL, 0x17DA7C1F49A59E31ULL,
    0x609C4C1328E194D3ULL, 0xB3E3D57232F44B09ULL, 0x91D7AAA4A512F69BULL, 0x0FFD6FD243DABBCCULL,
    0x50D26A943C1FDE34ULL, 0x6BE15E9968545B4FULL, 0x94778FEA6FAF9FDFULL, 0x2B09DD7058EA4826ULL,
    0x677CD9716DE5C7BFULL, 0x49D5214FFFB2E6DDULL, 0x0360E83A466B273CULL, 0x1FC786AF4F7B7691ULL,
    0xA0B9D435783EA168ULL, 0xD49F0C035F118CB6ULL, 0x01205816C9D21D14ULL, 0xAC2453DD7D8F3D98ULL,
    0x545217CC3F70AA64ULL, 0x26B4028E9489C9C2ULL, 0xDEC2469FD6765E3EULL, 0x04807D58036F7450ULL,
    0xE5F17292823DDB45ULL, 0xF30B569B024A5860ULL, 0x62DCFC3FA758AEFBULL, 0xE84CAD6C4E5E5AA1ULL,
    0xCCB81FCE556EA94BULL, 0x53B282AE7A74F908ULL, 0x1B47FBF74C1402C1ULL, 0x368EEBF39828049FULL,
    0x7AFBEFF2AD278B06ULL, 0xBE5E0A8CFE97CAEDULL, 0xCFD8F7F413058E77ULL, 0xF78B2BC301252C30ULL,
    0x4D555C17FCDD928DULL, 0x5F2F05467FC565F8ULL, 0x24F4B2A21B30F3EAULL, 0x860DD6BBECB768AAULL,
    0x4C750401350F8F99ULL, 0x0000000000000000ULL, 0xECCCD0344D312EF1ULL, 0xB5231806BE220571ULL,
    0xC105C030990D28AFULL, 0x653C695DE25CFD97ULL, 0x159ACC33C61CA419ULL, 0xB89EC7F872418495ULL,
    0xA9847693B73254DCULL, 0x58CF90243AC13694ULL, 0x59EFC832F3132B80ULL, 0x5C4FED7C39AE42C4ULL,
    0x828DABE3EFD81CFAULL, 0xD13F294D95ACE5F2ULL, 0x7D1B7A90E823D86AULL, 0xB643F03CF849224DULL,
    0x3DF3F979D89DCB03ULL, 0x7426D836272F2DDEULL, 0xDFE21E891FA4432AULL, 0x3A136C1B9D99986FULL,
    0xFA36F43DCD46ADD4ULL, 0xC025982650DF35BBULL, 0x856D3E81AADC4F96ULL, 0xC4A5E57E53B041EBULL,
    0x4708168B75BA4005ULL, 0xAF44BBE73BE41AA4ULL, 0x971767D029C4B8E3ULL, 0xB9BE9FEEBB939981ULL,
    0x215497ECD18D9AAEULL, 0x316E7E91DD2C57F3ULL, 0xCEF8AFE2DAD79363ULL, 0x3853DC371220A247ULL,
    0x35EE03C9DE4323A3ULL, 0xE6919AA8C456FC79ULL, 0xE05157DC4880B201ULL, 0x7BDBB7E464F59612ULL,
    0x127A59518318F775ULL, 0x332ECEBD52956DDBULL, 0x8F30741D23BB9D1EULL, 0xD922D3FD93720D52ULL,
    0x7746300C61440AE2ULL, 0x25D4EAB4D2E2EEFEULL, 0x75068020EEFD30CAULL, 0x135A01474ACAEA61ULL,
    0x304E268714FE4AE7ULL, 0xA519F17BB283C82CULL, 0xDC82F6B359CF6416ULL, 0x5BAF781E7CAA11A8ULL,
    0xB2C38D64FB26561DULL, 0x34CE5BDF17913EB7ULL, 0x5D6FB56AF07C5FD0ULL, 0x182713CD0A7F25FDULL,
    0x9E2AC576E6C84D57ULL, 0x9AAAB82EE5A73907ULL, 0xA3D93C0F3E558654ULL, 0x7E7B92AAAE48FF56ULL,
    0x872D8EAD256575BEULL, 0x41C8DBFFF96C0E7DULL, 0x99CA5014A3CC1E3BULL, 0x40E883E930BE1369ULL,
    0x1CA76E95091051ADULL, 0x4E35B42DBAB6B5B1ULL, 0x05A0254ECABD6944ULL, 0xE1710FCA8152AF15ULL,
    0xF22B0E8DCB984574ULL, 0xB763A82A319B3F59ULL, 0x63FCA4296E8AB3EFULL, 0x9D4A2D4CA0A36A6BULL,
    0xE331BFE60EEB953DULL, 0xD5BF541596C391A2ULL, 0xF5CB9BEF8E9C1618ULL, 0x46284E9DBC685D11ULL,
    0x2074CFFA185F87BAULL, 0xBD3EE2B6B8FCEDD1ULL, 0xAE64E3F1F23607B0ULL, 0xFEB68965CE29D984ULL,
    0x55724FDAF6A2B770ULL, 0x29496D5CD753720EULL, 0xA75941573D3AF204ULL, 0x8E102C0BEA69800AULL,
    0x111AB16BC573D049ULL, 0xD7FFE439197AAB8AULL, 0xEFAC380E0B5A09CDULL, 0x48F579593660FBC9ULL,
    0x22347FD697E6BD92ULL, 0x61BC1405E13389C7ULL, 0x4AB5C975B9D9C1E1ULL, 0x80CD1BCF606126D2ULL,
    0x7186FD78ED92449AULL, 0x93971A882AABCCB3ULL, 0x88D0E17F66BFCE72ULL, 0x27945A985D5BD4D6ULL },
{
    0xDE553F8C05A811C8ULL, 0x1906B59631B4F565ULL, 0x436E70D6B1964FF7ULL, 0x36D343CB8B1E9D85ULL,
    0x843DFACC858AAB5AULL, 0xFDFC95C299BFC7F9ULL, 0x0F634BDEA1D51FA2ULL, 0x6D458B3B76EFB3CDULL,
    0x85C3F77CF8593F80ULL, 0x3C91315FBE737CB2ULL, 0x2148B03366ACE398ULL, 0x18F8B8264C6761BFULL,
    0xC830C1C495C9FB0FULL, 0x981A76102086A0AAULL, 0xAA16012142F35760ULL, 0x35CC54060C763CF6ULL,
    0x42907D66CC45DB2DULL, 0x8203D44B965AF4BCULL, 0x3D6F3CEFC3A0E868ULL, 0xBC73FF69D292BDA7ULL,
    0x8722ED0102E20A29ULL, 0x8F8185E8CD34DEB7ULL, 0x9B0561DDA7EE01D9ULL, 0x5335A0193227FAD6ULL,
    0xC9CECC74E81A6FD5ULL, 0x54F5832E5C2431EAULL, 0x99E47BA05D553470ULL, 0xF7BEE756ACD226CEULL,
    0x384E05A5571816FDULL, 0xD1367452A47D0E6AULL, 0xF29FDE1C386AD85BULL, 0x320C77316275F7CAULL,
    0xD0C879E2D9AE9AB0ULL, 0xDB7406C69110EF5DULL, 0x45505E51A2461011ULL, 0xFC029872E46C5323ULL,
    0xFA3CB6F5F7BC0CC5ULL, 0x031F17CD8768A173ULL, 0xBD8DF2D9AF41297DULL, 0x9D3B4F5AB43E5E3FULL,
    0x4071671B36FEEE84ULL, 0x716207E7D3E3B83DULL, 0x48D20FF2F9283A1AULL, 0x27769EB4757CBC7EULL,
    0x5C56EBC793F2E574ULL, 0xA48B474F9EF5DC18ULL, 0x52CBADA94FF46E0CULL, 0x60C7DA982D8199C6ULL,
    0x0E9D466EDC068B78ULL, 0x4EEC2175EAF865FCULL, 0x550B8E9E21F7A530ULL, 0x6B7BA5BC653FEC2BULL,
    0x5EB7F1BA6949D0DDULL, 0x57EA94E3DB4C9099ULL, 0xF640EAE6D101B214ULL, 0xDD4A284182C0B0BBULL,
    0xFF1D8FBF6304F250ULL, 0xB8ACCB933BF9D7E8ULL, 0xE8867C478EB68C4DULL, 0x3F8E2692391BDDC1ULL,
    0xCB2FD60912A15A7CULL, 0xAEC935DBAB983D2FULL, 0xF55FFD2B56691367ULL, 0x80E2CE366CE1C115ULL,
    0x179BF3F8EDB27E1DULL, 0x01FE0DB07DD394DAULL, 0xDA8A0B76ECC37B87ULL, 0x44AE53E1DF9584CBULL,
    0xB310B4B77347A205ULL, 0xDFAB323C787B8512ULL, 0x3B511268D070B78EULL, 0x65E6E3D2B9396753ULL,
    0x6864B271E2574D58ULL, 0x259784C98FC789D7ULL, 0x02E11A7DFABB35A9ULL, 0x8841A6DFA337158BULL,
    0x7ADE78C39B5DCDD0ULL, 0xB7CF804D9A2CC84AULL, 0x20B6BD831B7F7742ULL, 0x75BD331D3A88D272ULL,
    0x418F6AAB4B2D7A5EULL, 0xD9951CBB6BABDAF4ULL, 0xB6318DFDE7FF5C90ULL, 0x1F389B112264AA83ULL,
    0x492C024284FBAEC0ULL, 0xE33A0363C608F9A0ULL, 0x2688930408AF28A4ULL, 0xC7538A1A341CE4ADULL,
    0x5DA8E677EE2171AEULL, 0x8C9E92254A5C7FC4ULL, 0x63D8CD55AAE938B5ULL, 0x29EBD8DAA97A3706ULL,
    0x959827B37BE88AA1ULL, 0x1484E4356ADADF6EULL, 0xA7945082199D7D6BULL, 0xBF6CE8A455FA1CD4ULL,
    0x9CC542EAC9EDCAE5ULL, 0x79C16F0E1C356CA3ULL, 0x89BFAB6FDEE48151ULL, 0xD4174D1830C5F0FFULL,
    0x9258048415EB419DULL, 0x6139D72850520D1CULL, 0x6A85A80C18EC78F1ULL, 0xCD11F88E0171059AULL,
    0xCCEFF53E7CA29140ULL, 0xD229639F2315AF19ULL, 0x90B91EF9EF507434ULL, 0x5977D28D074A1BE1ULL,
    0x311360FCE51D56B9ULL, 0xC093A92D5A1F2F91ULL, 0x1A19A25BB6DC5416ULL, 0xEB996B8A09DE2D3EULL,
    0xFEE3820F1ED7668AULL, 0xD7085AD5B7AD518CULL, 0x7FFF41890FE53345ULL, 0xEC5948BD67DDE602ULL,
    0x2FD5F65DBAAA68E0ULL, 0xA5754AFFE32648C2ULL, 0xF8DDAC880D07396CULL, 0x6FA491468C548664ULL,
    0x0C7C5C1326BDBED1ULL, 0x4A33158F03930FB3ULL, 0x699ABFC19F84D982ULL, 0xE4FA2054A80B329CULL,
    0x6707F9AF438252FAULL, 0x08A368E9CFD6D49EULL, 0x47B1442C58FD25B8ULL, 0xBBB3DC5EBC91769BULL,
    0x1665FE489061EAC7ULL, 0x33F27A811FA66310ULL, 0x93A609346838D547ULL, 0x30ED6D4C98CEC263ULL,
    0x1DD9816CD8DF9F2AULL, 0x94662A03063B1E7BULL, 0x83FDD9FBEB896066ULL, 0x7B207573E68E590AULL,
    0x5F49FC0A149A4407ULL, 0x343259B671A5A82CULL, 0xFBC2BB458A6F981FULL, 0xC272B350A0A41A38ULL,
    0x3AAF1FD8ADA32354ULL, 0x6CBB868B0B3C2717ULL, 0xA2B569C88D2583FEULL, 0xF180C9D1BF027928ULL,
    0xAF37386BD64BA9F5ULL, 0x12BACAB2790A8088ULL, 0x4C0D3B0810435055ULL, 0xB2EEB9070E9436DFULL,
    0xC5B29067CEA7D104ULL, 0xDCB425F1FF132461ULL, 0x4F122CC5972BF126ULL, 0xAC282FA651230886ULL,
    0xE7E537992F6393EFULL, 0xE61B3A2952B00735ULL, 0x709C0A57AE302CE7ULL, 0xE02514AE416058D3ULL,
    0xC44C9DD7B37445DEULL, 0x5A68C5408022BA92ULL, 0x1C278CDCA50C0BF0ULL, 0x6E5A9CF6F18712BEULL,
    0x86DCE0B17F319EF3ULL, 0x2D34EC2040115D49ULL, 0x4BCD183F7E409B69ULL, 0x2815D56AD4A9A3DCULL,
    0x24698979F2141D0DULL, 0x0000000000000000ULL, 0x1EC696A15FB73E59ULL, 0xD86B110B16784E2EULL,
    0x8E7F8858B0E74A6DULL, 0x063E2E8713D05FE6ULL, 0xE2C40ED3BBDB6D7AULL, 0xB1F1AECA89FC97ACULL,
    0xE1DB191E3CB3CC09ULL, 0x6418EE62C4EAF389ULL, 0xC6AD87AA49CF7077ULL, 0xD6F65765CA7EC556ULL,
    0x9AFB6C6DDA3D9503ULL, 0x7CE05644888D9236ULL, 0x8D609F95378FEB1EULL, 0x23A9AA4E9C17D631ULL,
    0x6226C0E5D73AAC6FULL, 0x56149953A69F0443ULL, 0xEEB852C09D66D3ABULL, 0x2B0AC2A753C102AFULL,
    0x07C023376E03CB3CULL, 0x2CCAE1903DC2C993ULL, 0xD3D76E2F5EC63BC3ULL, 0x9E2458973356FF4CULL,
    0xA66A5D32644EE9B1ULL, 0x0A427294356DE137ULL, 0x783F62BE61E6F879ULL, 0x1344C70204D91452ULL,
    0x5B96C8F0FDF12E48ULL, 0xA90916ECC59BF613ULL, 0xBE92E5142829880EULL, 0x727D102A548B194EULL,
    0x1BE7AFEBCB0FC0CCULL, 0x3E702B2244C8491BULL, 0xD5E940A84D166425ULL, 0x66F9F41F3E51C620ULL,
    0xABE80C913F20C3BAULL, 0xF07EC461C2D1EDF2ULL, 0xF361D3AC45B94C81ULL, 0x0521394A94B8FE95ULL,
    0xADD622162CF09C5CULL, 0xE97871F7F3651897ULL, 0xF4A1F09B2BBA87BDULL, 0x095D6559B2054044ULL,
    0x0BBC7F2448BE75EDULL, 0x2AF4CF172E129675ULL, 0x157AE98517094BB4ULL, 0x9FDA55274E856B96ULL,
    0x914713499283E0EEULL, 0xB952C623462A4332ULL, 0x74433EAD475B46A8ULL, 0x8B5EB112245FB4F8ULL,
    0xA34B6478F0F61724ULL, 0x11A5DD7FFE6221FBULL, 0xC16DA49D27CCBB4BULL, 0x76A224D0BDE07301ULL,
    0x8AA0BCA2598C2022ULL, 0x4DF336B86D90C48FULL, 0xEA67663A740DB9E4ULL, 0xEF465F70E0B54771ULL,
    0x39B008152ACB8227ULL, 0x7D1E5BF4F55E06ECULL, 0x105BD0CF83B1B521ULL, 0x775C2960C033E7DBULL,
    0x7E014C397236A79FULL, 0x811CC386113255CFULL, 0xEDA7450D1A0E72D8ULL, 0x5889DF3D7A998F3BULL,
    0x2E2BFBEDC779FC3AULL, 0xCE0EEF438619A4E9ULL, 0x372D4E7BF6CD095FULL, 0x04DF34FAE96B6A4FULL,
    0xF923A13870D4ADB6ULL, 0xA1AA7E050A4D228DULL, 0xA8F71B5CB84862C9ULL, 0xB52E9A306097FDE3ULL,
    0x0D8251A35B6E2A0BULL, 0x2257A7FEE1C442EBULL, 0x73831D9A29588D94ULL, 0x51D4BA64C89CCF7FULL,
    0x502AB7D4B54F5BA5ULL, 0x97793DCE8153BF08ULL, 0xE5042DE4D5D8A646ULL, 0x9687307EFC802BD2ULL,
    0xA05473B5779EB657ULL, 0xB4D097801D446939ULL, 0xCFF0E2F3FBCA3033ULL, 0xC38CBEE0DD778EE2ULL,
    0x464F499C252EB162ULL, 0xCAD1DBB96F72CEA6ULL, 0xBA4DD1EEC142E241ULL, 0xB00FA37AF42F0376ULL },
{
    0xCCE4CD3AA968B245ULL, 0x089D5484E80B7FAFULL, 0x638246C1B3548304ULL, 0xD2FE0EC8C2355492ULL,
    0xA7FBDF7FF2374EEEULL, 0x4DF1600C92337A16ULL, 0x84E503EA523B12FBULL, 0x0790BBFD53AB0C4AULL,
    0x198A780F38F6EA9DULL, 0x2AB30C8F55EC48CBULL, 0xE0F7FED6B2C49DB5ULL, 0xB6ECF3F422CADBDCULL,
    0x409C9A541358DF11ULL, 0xD3CE8A56DFDE3FE3ULL, 0xC3E9224312C8C1A0ULL, 0x0D6DFA58816BA507ULL,
    0xDDF3E1B179952777ULL, 0x04C02A42748BB1D9ULL, 0x94C2ABFF9F2DECB8ULL, 0x4F91752DA8F8ACF4ULL,
    0x78682BEFB169BF7BULL, 0xE1C77A48AF2FF6C4ULL, 0x0C5D7EC69C80CE76ULL, 0x4CC1E4928FD81167ULL,
    0xFEED3D24D9997B62ULL, 0x518BB6DFC3A54A23ULL, 0x6DBF2D26151F9B90ULL, 0xB5BC624B05EA664FULL,
    0xE86AAA525ACFE21AULL, 0x4801CED0FB53A0BEULL, 0xC91463E6C00868EDULL, 0x1027A815CD16FE43ULL,
    0xF67069A0319204CDULL, 0xB04CCC976C8ABCE7ULL, 0xC0B9B3FC35E87C33ULL, 0xF380C77C58F2DE65ULL,
    0x50BB3241DE4E2152ULL, 0xDF93F490435EF195ULL, 0xF1E0D25D62390887ULL, 0xAF668BFB1A3C3141ULL,
    0xBC11B251F00A7291ULL, 0x73A5EED47E427D47ULL, 0x25BEE3F6EE4C3B2EULL, 0x43CC0BEB34786282ULL,
    0xC824E778DDE3039CULL, 0xF97D86D98A327728ULL, 0xF2B043E24519B514ULL, 0xE297EBF7880F4B57ULL,
    0x3A94A49A98FAB688ULL, 0x868516CB68F0C419ULL, 0xEFFA11AF0964EE50ULL, 0xA4AB4EC0D517F37DULL,
    0xA9C6B498547C567AULL, 0x8E18424F80FBBBB6ULL, 0x0BCDC53BCF2BC23CULL, 0x137739AAEA3643D0ULL,
    0x2C1333EC1BAC2FF0ULL, 0x8D48D3F0A7DB0625ULL, 0x1E1AC3F26B5DE6D7ULL, 0xF520F81F16B2B95EULL,
    0x9F0F6EC450062E84ULL, 0x0130849E1DEB6B71ULL, 0xD45E31AB8C7533A9ULL, 0x652279A2FD14E43FULL,
    0x3209F01E70F1C927ULL, 0xBE71A770CAC1A473ULL, 0x0E3D6BE7A64B1894ULL, 0x7EC8148CFF29D840ULL,
    0xCB7476C7FAC3BE0FULL, 0x72956A4A63A91636ULL, 0x37F95EC21991138FULL, 0x9E3FEA5A4DED45F5ULL,
    0x7B38BA50964902E8ULL, 0x222E580BBDE73764ULL, 0x61E253E0899F55E6ULL, 0xFC8D2805E352AD80ULL,
    0x35994BE3235AC56DULL, 0x09ADD01AF5E014DEULL, 0x5E8659A6780539C6ULL, 0xB17C48097161D796ULL,
    0x026015213ACBD6E2ULL, 0xD1AE9F77E515E901ULL, 0xB7DC776A3F21B0ADULL, 0xABA6A1B96EB78098ULL,
    0x9BCF4486248D9F5DULL, 0x582666C536455EFDULL, 0xFDBDAC9BFEB9C6F1ULL, 0xC47999BE4163CDEAULL,
    0x765540081722A7EFULL, 0x3E548ED8EC710751ULL, 0x3D041F67CB51BAC2ULL, 0x7958AF71AC82D40AULL,
    0x36C9DA5C047A78FEULL, 0xED9A048E33AF38B2ULL, 0x26EE7249C96C86BDULL, 0x900281BDEBA65D61ULL,
    0x11172C8BD0FD9532ULL, 0xEA0ABF73600434F8ULL, 0x42FC8F75299309F3ULL, 0x34A9CF7D3EB1AE1CULL,
    0x2B838811480723BAULL, 0x5CE64C8742CEEF24ULL, 0x1ADAE9B01FD6570EULL, 0x3C349BF9D6BAD1B3ULL,
    0x82453C891C7B75C0ULL, 0x97923A40B80D512BULL, 0x4A61DBF1C198765CULL, 0xB48CE6D518010D3EULL,
    0xCFB45C858E480FD6ULL, 0xD933CBF30D1E96AEULL, 0xD70EA014AB558E3AULL, 0xC189376228031742ULL,
    0x9262949CD16D8B83ULL, 0xEB3A3BED7DEF5F89ULL, 0x49314A4EE6B8CBCFULL, 0xDCC3652F647E4C06ULL,
    0xDA635A4C2A3E2B3DULL, 0x470C21A940F3D35BULL, 0x315961A157D174B4ULL, 0x6672E81DDA3459ACULL,
    0x5B76F77A1165E36EULL, 0x445CB01667D36EC8ULL, 0xC5491D205C88A69BULL, 0x456C34887A3805B9ULL,
    0xFFDDB9BAC4721013ULL, 0x99AF51A71E4649BFULL, 0xA15BE01CBC7729D5ULL, 0x52DB2760E485F7B0ULL,
    0x8C78576EBA306D54ULL, 0xAE560F6507D75A30ULL, 0x95F22F6182C687C9ULL, 0x71C5FBF54489ABA5ULL,
    0xCA44F259E728D57EULL, 0x88B87D2CCEBBDC8DULL, 0xBAB18D32BE4A15AAULL, 0x8BE8EC93E99B611EULL,
    0x17B713E89EBDF209ULL, 0xB31C5D284BAA0174ULL, 0xEECA9531148F8521ULL, 0xB8D198138481C348ULL,
    0x8988F9B2D350B7FCULL, 0xB9E11C8D996AA839ULL, 0x5A4673E40C8E881FULL, 0x1687977683569978ULL,
    0xBF4123EED72ACF02ULL, 0x4EA1F1B3B513C785ULL, 0xE767452BE16F91FFULL, 0x7505D1B730021A7CULL,
    0xA59BCA5EC8FC980CULL, 0xAD069EDA20F7E7A3ULL, 0x38F4B1BBA231606AULL, 0x60D2D77E94743E97ULL,
    0x9AFFC0183966F42CULL, 0x248E6768F3A7505FULL, 0xCDD449A4B483D934ULL, 0x87B59255751BAF68ULL,
    0x1BEA6D2E023D3C7FULL, 0x6B1F12455B5FFCABULL, 0x743555292DE9710DULL, 0xD8034F6D10F5FDDFULL,
    0xC6198C9F7BA81B08ULL, 0xBB8109ACA3A17EDBULL, 0xFA2D1766AD12CABBULL, 0xC729080166437079ULL,
    0x9C5FFF7B77269317ULL, 0x0000000000000000ULL, 0x15D706C9A47624EBULL, 0x6FDF38072FD44D72ULL,
    0x5FB6DD3865EE52B7ULL, 0xA33BF53D86BCFF37ULL, 0xE657C1B5FC84FA8EULL, 0xAA962527735CEBE9ULL,
    0x39C43525BFDA0B1BULL, 0x204E4D2A872CE186ULL, 0x7A083ECE8BA26999ULL, 0x554B9C9DB72EFBFAULL,
    0xB22CD9B656416A05ULL, 0x96A2BEDEA5E63A5AULL, 0x802529A826B0A322ULL, 0x8115AD363B5BC853ULL,
    0x8375B81701901EB1ULL, 0x3069E53F4A3A1FC5ULL, 0xBD2136CFEDE119E0ULL, 0x18BAFC91251D81ECULL,
    0x1D4A524D4C7D5B44ULL, 0x05F0AEDC6960DAA8ULL, 0x29E39D3072CCF558ULL, 0x70F57F6B5962C0D4ULL,
    0x989FD53903AD22CEULL, 0xF84D024797D91C59ULL, 0x547B1803AAC5908BULL, 0xF0D056C37FD263F6ULL,
    0xD56EB535919E58D8ULL, 0x1C7AD6D351963035ULL, 0x2E7326CD2167F912ULL, 0xAC361A443D1C8CD2ULL,
    0x697F076461942A49ULL, 0x4B515F6FDC731D2DULL, 0x8AD8680DF4700A6FULL, 0x41AC1ECA0EB3B460ULL,
    0x7D988533D80965D3ULL, 0xA8F6300649973D0BULL, 0x7765C4960AC9CC9EULL, 0x7CA801ADC5E20EA2ULL,
    0xDEA3700E5EB59AE4ULL, 0xA06B6482A19C42A4ULL, 0x6A2F96DB46B497DAULL, 0x27DEF6D7D487EDCCULL,
    0x463CA5375D18B82AULL, 0xA6CB5BE1EFDC259FULL, 0x53EBA3FEF96E9CC1ULL, 0xCE84D81B93A364A7ULL,
    0xF4107C810B59D22FULL, 0x333974806D1AA256ULL, 0x0F0DEF79BBA073E5ULL, 0x231EDC95A00C5C15ULL,
    0xE437D494C64F2C6CULL, 0x91320523F64D3610ULL, 0x67426C83C7DF32DDULL, 0x6EEFBC99323F2603ULL,
    0x9D6F7BE56ACDF866ULL, 0x5916E25B2BAE358CULL, 0x7FF89012E2C2B331ULL, 0x035091BF2720BD93ULL,
    0x561B0D22900E4669ULL, 0x28D319AE6F279E29ULL, 0x2F43A2533C8C9263ULL, 0xD09E1BE9F8FE8270ULL,
    0xF740ED3E2C796FBCULL, 0xDB53DED237D5404CULL, 0x62B2C25FAEBFE875ULL, 0x0AFD41A5D2C0A94DULL,
    0x6412FD3CE0FF8F4EULL, 0xE3A76F6995E42026ULL, 0x6C8FA9B808F4F0E1ULL, 0xC2D9A6DD0F23AAD1ULL,
    0x8F28C6D19D10D0C7ULL, 0x85D587744FD0798AULL, 0xA20B71A39B579446ULL, 0x684F83FA7C7F4138ULL,
    0xE507500ADBA4471DULL, 0x3F640A46F19A6C20ULL, 0x1247BD34F7DD28A1ULL, 0x2D23B77206474481ULL,
    0x93521002CC86E0F2ULL, 0x572B89BC8DE52D18ULL, 0xFB1D93F8B0F9A1CAULL, 0xE95A2ECC4724896BULL,
    0x3BA420048511DDF9ULL, 0xD63E248AB6BEE54BULL, 0x5DD6C8195F258455ULL, 0x06A03F634E40673BULL,
    0x1F2A476C76B68DA6ULL, 0x217EC9B49AC78AF7ULL, 0xECAA80102E4453C3ULL, 0x14E78257B99D4F9AULL },
{
    0x20329B2CC87BBA05ULL, 0x4F5EB6F86546A531ULL, 0xD4F44775F751B6B1ULL, 0x8266A47B850DFA8BULL,
    0xBB986AA15A6CA985ULL, 0xC979EB08F9AE0F99ULL, 0x2DA6F447A2375EA1ULL, 0x1E74275DCD7D8576ULL,
    0xBC20180A800BC5F8ULL, 0xB4A2F701B2DC65BEULL, 0xE726946F981B6D66ULL, 0x48E6C453BF21C94CULL,
    0x42CAD9930F0A4195ULL, 0xEFA47B64AACCCD20ULL, 0x71180A8960409A42ULL, 0x8BB3329BF6A44E0CULL,
    0xD34C35DE2D36DACCULL, 0xA92F5B7CBC23DC96ULL, 0xB31A85AA68BB09C3ULL, 0x13E04836A73161D2ULL,
    0xB24DFC4129C51D02ULL, 0x8AE44B70B7DA5ACDULL, 0xE671ED84D96579A7ULL, 0xA4BB3417D66F3832ULL,
    0x4572AB38D56D2DE8ULL, 0xB1B47761EA47215CULL, 0xE81C09CF70ABA15DULL, 0xFFBDB872CE7F90ACULL,
    0xA8782297FD5DC857ULL, 0x0D946F6B6A4CE4A4ULL, 0xE4DF1F4F5B995138ULL, 0x9EBC71EDCA8C5762ULL,
    0x0A2C1DC0B02B88D9ULL, 0x3B503C115D9D7B91ULL, 0xC64376A8111EC3A2ULL, 0xCEC199A323C963E4ULL,
    0xDC76A87EC58616F7ULL, 0x09D596E073A9B487ULL, 0x14583A9D7D560DAFULL, 0xF4C6DC593F2A0CB4ULL,
    0xDD21D19584F80236ULL, 0x4A4836983DDDE1D3ULL, 0xE58866A41AE745F9ULL, 0xF591A5B27E541875ULL,
    0x891DC05074586693ULL, 0x5B068C651810A89EULL, 0xA30346BC0C08544FULL, 0x3DBF3751C684032DULL,
    0x2A1E86EC785032DCULL, 0xF73F5779FCA830EAULL, 0xB60C05CA30204D21ULL, 0x0CC316802B32F065ULL,
    0x8770241BDD96BE69ULL, 0xB861E18199EE95DBULL, 0xF805CAD91418FCD1ULL, 0x29E70DCCBBD20E82ULL,
    0xC7140F435060D763ULL, 0x0F3A9DA0E8B0CC3BULL, 0xA2543F574D76408EULL, 0xBD7761E1C175D139ULL,
    0x4B1F4F737CA3F512ULL, 0x6DC2DF1F2FC137ABULL, 0xF1D05C3967B14856ULL, 0xA742BF3715ED046CULL,
    0x654030141D1697EDULL, 0x07B872ABDA676C7DULL, 0x3CE84EBA87FA17ECULL, 0xC1FB0403CB79AFDFULL,
    0x3E46BC7105063F73ULL, 0x278AE987121CD678ULL, 0xA1ADB4778EF47CD0ULL, 0x26DD906C5362C2B9ULL,
    0x05168060589B44E2ULL, 0xFBFC41F9D79AC08FULL, 0x0E6DE44BA9CED8FAULL, 0x9FEB08068BF243A3ULL,
    0x7B341749D06B129BULL, 0x229C69E74A87929AULL, 0xE09EE6C4427C011BULL, 0x5692E30E725C4C3AULL,
    0xDA99A33E5E9F6E4BULL, 0x353DD85AF453A36BULL, 0x25241B4C90E0FEE7ULL, 0x5DE987258309D022ULL,
    0xE230140FC0802984ULL, 0x93281E86A0C0B3C6ULL, 0xF229D719A4337408ULL, 0x6F6C2DD4AD3D1F34ULL,
    0x8EA5B2FBAE3F0AEEULL, 0x8331DD90C473EE4AULL, 0x346AA1B1B52DB7AAULL, 0xDF8F235E06042AA9ULL,
    0xCC6F6B68A1354B7BULL, 0x6C95A6F46EBF236AULL, 0x52D31A856BB91C19ULL, 0x1A35DED6D498D555ULL,
    0xF37EAEF2E54D60C9ULL, 0x72E181A9A3C2A61CULL, 0x98537AAD51952FDEULL, 0x16F6C856FFAA2530ULL,
    0xD960281E9D1D5215ULL, 0x3A0745FA1CE36F50ULL, 0x0B7B642BF1559C18ULL, 0x59A87EAE9AEC8001ULL,
    0x5E100C05408BEC7CULL, 0x0441F98B19E55023ULL, 0xD70DCC5534D38AEFULL, 0x927F676DE1BEA707ULL,
    0x9769E70DB925E3E5ULL, 0x7A636EA29115065AULL, 0x468B201816EF11B6ULL, 0xAB81A9B73EDFF409ULL,
    0xC0AC7DE88A07BB1EULL, 0x1F235EB68C0391B7ULL, 0x6056B074458DD30FULL, 0xBE8EEAC102F7ED67ULL,
    0xCD381283E04B5FBAULL, 0x5CBEFECEC277C4E3ULL, 0xD21B4C356C48CE0DULL, 0x1019C31664B35D8CULL,
    0x247362A7D19EEA26ULL, 0xEBE582EFB3299D03ULL, 0x02AEF2CB82FC289FULL, 0x86275DF09CE8AAA8ULL,
    0x28B07427FAAC1A43ULL, 0x38A9B7319E1F47CFULL, 0xC82E92E3B8D01B58ULL, 0x06EF0B409B1978BCULL,
    0x62F842BFC771FB90ULL, 0x9904034610EB3B1FULL, 0xDED85AB5477A3E68ULL, 0x90D195A663428F98ULL,
    0x5384636E2AC708D8ULL, 0xCBD719C37B522706ULL, 0xAE9729D76644B0EBULL, 0x7C8C65E20A0C7EE6ULL,
    0x80C856B007F1D214ULL, 0x8C0B40302CC32271ULL, 0xDBCEDAD51FE17A8AULL, 0x740E8AE938DBDEA0ULL,
    0xA615C6DC549310ADULL, 0x19CC55F6171AE90BULL, 0x49B1BDB8FE5FDD8DULL, 0xED0A89AF2830E5BFULL,
    0x6A7AADB4F5A65BD6ULL, 0x7E22972988F05679ULL, 0xF952B3325566E810ULL, 0x39FECEDADF61530EULL,
    0x6101C99F04F3C7CEULL, 0x2E5F7F6761B562FFULL, 0xF08725D226CF5C97ULL, 0x63AF3B54860FEF51ULL,
    0x8FF2CB10EF411E2FULL, 0x884AB9BB35267252ULL, 0x4DF04433E7BA8DAEULL, 0x9AFD8866D3690741ULL,
    0x66B9BB34DE94ABB3ULL, 0x9BAAF18D92171380ULL, 0x543C11C5F0A064A5ULL, 0x17A1B1BDBED431F1ULL,
    0xB5F58EEAF3A2717FULL, 0xC355F6C849858740ULL, 0xEC5DF044694EF17EULL, 0xD83751F5DC6346D4ULL,
    0xFC4433520DFDACF2ULL, 0x0000000000000000ULL, 0x5A51F58E596EBC5FULL, 0x3285AAF12E34CF16ULL,
    0x8D5C39DB6DBD36B0ULL, 0x12B731DDE64F7513ULL, 0x94906C2D7AA7DFBBULL, 0x302B583AACC8E789ULL,
    0x9D45FACD090E6B3CULL, 0x2165E2C78905AEC4ULL, 0x68D45F7F775A7349ULL, 0x189B2C1D5664FDCAULL,
    0xE1C99F2F030215DAULL, 0x6983269436246788ULL, 0x8489AF3B1E148237ULL, 0xE94B702431D5B59CULL,
    0x33D2D31A6F4ADBD7ULL, 0xBFD9932A4389F9A6ULL, 0xB0E30E8AAB39359DULL, 0xD1E2C715AFCAF253ULL,
    0x150F43763C28196EULL, 0xC4ED846393E2EB3DULL, 0x03F98B20C3823C5EULL, 0xFD134AB94C83B833ULL,
    0x556B682EB1DE7064ULL, 0x36C4537A37D19F35ULL, 0x7559F30279A5CA61ULL, 0x799AE58252973A04ULL,
    0x9C12832648707FFDULL, 0x78CD9C6913E92EC5ULL, 0x1D8DAC7D0EFFB928ULL, 0x439DA0784E745554ULL,
    0x413352B3CC887DCBULL, 0xBACF134A1B12BD44ULL, 0x114EBAFD25CD494DULL, 0x2F08068C20CB763EULL,
    0x76A07822BA27F63FULL, 0xEAB2FB04F25789C2ULL, 0xE3676DE481FE3D45ULL, 0x1B62A73D95E6C194ULL,
    0x641749FF5C68832CULL, 0xA5EC4DFC97112CF3ULL, 0xF6682E92BDD6242BULL, 0x3F11C59A44782BB2ULL,
    0x317C21D1EDB6F348ULL, 0xD65AB5BE75AD9E2EULL, 0x6B2DD45FB4D84F17ULL, 0xFAAB381296E4D44EULL,
    0xD0B5BEFEEEB4E692ULL, 0x0882EF0B32D7A046ULL, 0x512A91A5A83B2047ULL, 0x963E9EE6F85BF724ULL,
    0x4E09CF132438B1F0ULL, 0x77F701C9FB59E2FEULL, 0x7DDB1C094B726A27ULL, 0x5F4775EE01F5F8BDULL,
    0x9186EC4D223C9B59ULL, 0xFEEAC1998F01846DULL, 0xAC39DB1CE4B89874ULL, 0xB75B7C21715E59E0ULL,
    0xAFC0503C273AA42AULL, 0x6E3B543FEC430BF5ULL, 0x704F7362213E8E83ULL, 0x58FF0745DB9294C0ULL,
    0x67EEC2DF9FEABF72ULL, 0xA0FACD9CCF8A6811ULL, 0xB936986AD890811AULL, 0x95C715C63BD9CB7AULL,
    0xCA8060283A2C33C7ULL, 0x507DE84EE9453486ULL, 0x85DED6D05F6A96F6ULL, 0x1CDAD5964F81ADE9ULL,
    0xD5A33E9EB62FA270ULL, 0x40642B588DF6690AULL, 0x7F75EEC2C98E42B8ULL, 0x2CF18DACE3494A60ULL,
    0x23CB100C0BF9865BULL, 0xEEF3028FEBB2D9E1ULL, 0x4425D2D394133929ULL, 0xAAD6D05C7FA1E0C8ULL,
    0xAD6EA2F7A5C68CB5ULL, 0xC2028F2308FB9381ULL, 0x819F2F5B468FC6D5ULL, 0xC5BAFD88D29CFFFCULL,
    0x47DC59F357910577ULL, 0x2B49FF07392E261DULL, 0x57C59AE5332258FBULL, 0x73B6F842E2BCB2DDULL,
    0xCF96E04862B77725ULL, 0x4CA73DD8A6C4996FULL, 0x015779EB417E14C1ULL, 0x37932A9176AF8BF4ULL },
{ 
    0x190A2C9B249DF23EULL, 0x2F62F8B62263E1E9ULL, 0x7A7F754740993655ULL, 0x330B7BA4D5564D9FULL,
    0x4C17A16A46672582ULL, 0xB22F08EB7D05F5B8ULL, 0x535F47F40BC148CCULL, 0x3AEC5D27D4883037ULL,
    0x10ED0A1825438F96ULL, 0x516101F72C233D17ULL, 0x13CC6F949FD04EAEULL, 0x739853C441474BFDULL,
    0x653793D90D3F5B1BULL, 0x5240647B96B0FC2FULL, 0x0C84890AD27623E0ULL, 0xD7189B32703AAEA3ULL,
    0x2685DE3523BD9C41ULL, 0x99317C5B11BFFEFAULL, 0x0D9BAA854F079703ULL, 0x70B93648FBD48AC5ULL,
    0xA80441FCE30BC6BEULL, 0x7287704BDC36FF1EULL, 0xB65384ED33DC1F13ULL, 0xD36417343EE34408ULL,
    0x39CD38AB6E1BF10FULL, 0x5AB861770A1F3564ULL, 0x0EBACF09F594563BULL, 0xD04572B884708530ULL,
    0x3CAE9722BDB3AF47ULL, 0x4A556B6F2F5CBAF2ULL, 0xE1704F1F76C4BD74ULL, 0x5EC4ED7144C6DFCFULL,
    0x16AFC01D4C7810E6ULL, 0x283F113CD629CA7AULL, 0xAF59A8761741ED2DULL, 0xEED5A3991E215FACULL,
    0x3BF37EA849F984D4ULL, 0xE413E096A56CE33CULL, 0x2C439D3A98F020D1ULL, 0x637559DC6404C46BULL,
    0x9E6C95D1E5F5D569ULL, 0x24BB9836045FE99AULL, 0x44EFA466DAC8ECC9ULL, 0xC6EAB2A5C80895D6ULL,
    0x803B50C035220CC4ULL, 0x0321658CBA93C138ULL, 0x8F9EBC465DC7EE1CULL, 0xD15A5137190131D3ULL,
    0x0FA5EC8668E5E2D8ULL, 0x91C979578D1037B1ULL, 0x0642CA05693B9F70ULL, 0xEFCA80168350EB4FULL,
    0x38D21B24F36A45ECULL, 0xBEAB81E1AF73D658ULL, 0x8CBFD9CAE7542F24ULL, 0xFD19CC0D81F11102ULL,
    0x0AC6430FBB4DBC90ULL, 0x1D76A09D6A441895ULL, 0x2A01573FF1CBBFA1ULL, 0xB572E161894FDE2BULL,
    0x8124734FA853B827ULL, 0x614B1FDF43E6B1B0ULL, 0x68AC395C4238CC18ULL, 0x21D837BFD7F7B7D2ULL,
    0x20C714304A860331ULL, 0x5CFAAB726324AA14ULL, 0x74C5BA4EB50D606EULL, 0xF3A3030474654739ULL,
    0x23E671BCF015C209ULL, 0x45F087E947B9582AULL, 0xD8BD77B418DF4C7BULL, 0xE06F6C90EBB50997ULL,
    0x0BD96080263C0873ULL, 0x7E03F9410E40DCFEULL, 0xB8E94BE4C6484928ULL, 0xFB5B0608E8CA8E72ULL,
    0x1A2B49179E0E3306ULL, 0x4E29E76961855059ULL, 0x4F36C4E6FCF4E4BAULL, 0x49740EE395CF7BCAULL,
    0xC2963EA386D17F7DULL, 0x90D65AD810618352ULL, 0x12D34C1B02A1FA4DULL, 0xFA44258775BB3A91ULL,
    0x18150F14B9EC46DDULL, 0x1491861E6B9A653DULL, 0x9A1019D7AB2C3FC2ULL, 0x3668D42D06FE13D7ULL,
    0xDCC1FBB25606A6D0ULL, 0x969490DD795A1C22ULL, 0x3549B1A1BC6DD2EFULL, 0xC94F5E23A0ED770EULL,
    0xB9F6686B5B39FDCBULL, 0xC4D4F4A6EFEAE00DULL, 0xE732851A1FFF2204ULL, 0x94AAD6DE5EB869F9ULL,
    0x3F8FF2AE07206E7FULL, 0xFE38A9813B62D03AULL, 0xA7A1AD7A8BEE2466ULL, 0x7B6056C8DDE882B6ULL,
    0x302A1E286FC58CA7ULL, 0x8DA0FA457A259BC7ULL, 0xB3302B64E074415BULL, 0x5402AE7EFF8B635FULL,
    0x08F8050C9CAFC94BULL, 0xAE468BF98A3059CEULL, 0x88C355CCA98DC58FULL, 0xB10E6D67C7963480ULL,
    0xBAD70DE7E1AA3CF3ULL, 0xBFB4A26E320262BBULL, 0xCB711820870F02D5ULL, 0xCE12B7A954A75C9DULL,
    0x563CE87DD8691684ULL, 0x9F73B65E7884618AULL, 0x2B1E74B06CBA0B42ULL, 0x47CEC1EA605B2DF1ULL,
    0x1C698312F735AC76ULL, 0x5FDBCEFED9B76B2CULL, 0x831A354C8FB1CDFCULL, 0x820516C312C0791FULL,
    0xB74CA762AEADABF0ULL, 0xFC06EF821C80A5E1ULL, 0x5723CBF24518A267ULL, 0x9D4DF05D5F661451ULL,
    0x588627742DFD40BFULL, 0xDA8331B73F3D39A0ULL, 0x17B0E392D109A405ULL, 0xF965400BCF28FBA9ULL,
    0x7C3DBF4229A2A925ULL, 0x023E460327E275DBULL, 0x6CD0B55A0CE126B3ULL, 0xE62DA695828E96E7ULL,
    0x42AD6E63B3F373B9ULL, 0xE50CC319381D57DFULL, 0xC5CBD729729B54EEULL, 0x46D1E265FD2A9912ULL,
    0x6428B056904EEFF8ULL, 0x8BE23040131E04B7ULL, 0x6709D5DA2ADD2EC0ULL, 0x075DE98AF44A2B93ULL,
    0x8447DCC67BFBE66FULL, 0x6616F655B7AC9A23ULL, 0xD607B8BDED4B1A40ULL, 0x0563AF89D3A85E48ULL,
    0x3DB1B4AD20C21BA4ULL, 0x11F22997B8323B75ULL, 0x292032B34B587E99ULL, 0x7F1CDACE9331681DULL,
    0x8E819FC9C0B65AFFULL, 0xA1E3677FE2D5BB16ULL, 0xCD33D225EE349DA5ULL, 0xD9A2543B85AEF898ULL,
    0x795E10CBFA0AF76DULL, 0x25A4BBB9992E5D79ULL, 0x78413344677B438EULL, 0xF0826688CEF68601ULL,
    0xD27B34BBA392F0EBULL, 0x551D8DF162FAD7BCULL, 0x1E57C511D0D7D9ADULL, 0xDEFFBDB171E4D30BULL,
    0xF4FEEA8E802F6CAAULL, 0xA480C8F6317DE55EULL, 0xA0FC44F07FA40FF5ULL, 0x95B5F551C3C9DD1AULL,
    0x22F952336D6476EAULL, 0x0000000000000000ULL, 0xA6BE8EF5169F9085ULL, 0xCC2CF1AA73452946ULL,
    0x2E7DDB39BF12550AULL, 0xD526DD3157D8DB78ULL, 0x486B2D6C08BECF29ULL, 0x9B0F3A58365D8B21ULL,
    0xAC78CDFAADD22C15ULL, 0xBC95C7E28891A383ULL, 0x6A927F5F65DAB9C3ULL, 0xC3891D2C1BA0CB9EULL,
    0xEAA92F9F50F8B507ULL, 0xCF0D9426C9D6E87EULL, 0xCA6E3BAF1A7EB636ULL, 0xAB25247059980786ULL,
    0x69B31AD3DF4978FBULL, 0xE2512A93CC577C4CULL, 0xFF278A0EA61364D9ULL, 0x71A615C766A53E26ULL,
    0x89DC764334FC716CULL, 0xF87A638452594F4AULL, 0xF2BC208BE914F3DAULL, 0x8766B94AC1682757ULL,
    0xBBC82E687CDB8810ULL, 0x626A7A53F9757088ULL, 0xA2C202F358467A2EULL, 0x4D0882E5DB169161ULL,
    0x09E7268301DE7DA8ULL, 0xE897699C771AC0DCULL, 0xC8507DAC3D9CC3EDULL, 0xC0A878A0A1330AA6ULL,
    0x978BB352E42BA8C1ULL, 0xE9884A13EA6B743FULL, 0x279AFDBABECC28A2ULL, 0x047C8C064ED9EAABULL,
    0x507E2278B15289F4ULL, 0x599904FBB08CF45CULL, 0xBD8AE46D15E01760ULL, 0x31353DA7F2B43844ULL,
    0x8558FF49E68A528CULL, 0x76FBFC4D92EF15B5ULL, 0x3456922E211C660CULL, 0x86799AC55C1993B4ULL,
    0x3E90D1219A51DA9CULL, 0x2D5CBEB505819432ULL, 0x982E5FD48CCE4A19ULL, 0xDB9C1238A24C8D43ULL,
    0xD439FEBECAA96F9BULL, 0x418C0BEF0960B281ULL, 0x158EA591F6EBD1DEULL, 0x1F48E69E4DA66D4EULL,
    0x8AFD13CF8E6FB054ULL, 0xF5E1C9011D5ED849ULL, 0xE34E091C5126C8AFULL, 0xAD67EE7530A398F6ULL,
    0x43B24DEC2E82C75AULL, 0x75DA99C1287CD48DULL, 0x92E81CDB3783F689ULL, 0xA3DD217CC537CECDULL,
    0x60543C50DE970553ULL, 0x93F73F54AAF2426AULL, 0xA91B62737E7A725DULL, 0xF19D4507538732E2ULL,
    0x77E4DFC20F9EA156ULL, 0x7D229CCDB4D31DC6ULL, 0x1B346A98037F87E5ULL, 0xEDF4C615A4B29E94ULL,
    0x4093286094110662ULL, 0xB0114EE85AE78063ULL, 0x6FF1D0D6B672E78BULL, 0x6DCF96D591909250ULL,
    0xDFE09E3EEC9567E8ULL, 0x3214582B4827F97CULL, 0xB46DC2EE143E6AC8ULL, 0xF6C0AC8DA7CD1971ULL,
    0xEBB60C10CD8901E4ULL, 0xF7DF8F023ABCAD92ULL, 0x9C52D3D2C217A0B2ULL, 0x6B8D5CD0F8AB0D20ULL,
    0x3777F7A29B8FA734ULL, 0x011F238F9D71B4E3ULL, 0xC1B75B2F3C42BE45ULL, 0x5DE588FDFE551EF7ULL,
    0x6EEEF3592B035368ULL, 0xAA3A07FFC4E9B365ULL, 0xECEBE59A39C32A77ULL, 0x5BA742F8976E8187ULL,
    0x4B4A48E0B22D0E11ULL, 0xDDDED83DCB771233ULL, 0xA59FEB79AC0C51BDULL, 0xC7F5912A55792135ULL },
{
    0x6D6AE04668A9B08AULL, 0x3AB3F04B0BE8C743ULL, 0xE51E166B54B3C908ULL, 0xBE90A9EB35C2F139ULL,
    0xB2C7066637F2BEC1ULL, 0xAA6945613392202CULL, 0x9A28C36F3B5201EBULL, 0xDDCE5A93AB536994ULL,
    0x0E34133EF6382827ULL, 0x52A02BA1EC55048BULL, 0xA2F88F97C4B2A177ULL, 0x8640E513CA2251A5ULL,
    0xCDF1D36258137622ULL, 0xFE6CB708DEDF8DDBULL, 0x8A174A9EC8121E5DULL, 0x679896036B81560EULL,
    0x59ED033395795FEEULL, 0x1DD778AB8B74EDAFULL, 0xEE533EF92D9F926DULL, 0x2A8C79BAF8A8D8F5ULL,
    0x6BCF398E69B119F6ULL, 0xE20491742FAFDD95ULL, 0x276488E0809C2AECULL, 0xEA955B82D88F5CCEULL,
    0x7102C63A99D9E0C4ULL, 0xF9763017A5C39946ULL, 0x429FA2501F151B3DULL, 0x4659C72BEA05D59EULL,
    0x984B7FDCCF5A6634ULL, 0xF742232953FBB161ULL, 0x3041860E08C021C7ULL, 0x747BFD9616CD9386ULL,
    0x4BB1367192312787ULL, 0x1B72A1638A6C44D3ULL, 0x4A0E68A6E8359A66ULL, 0x169A5039F258B6CAULL,
    0xB98A2EF44EDEE5A4ULL, 0xD9083FE85E43A737ULL, 0x967F6CE239624E13ULL, 0x8874F62D3C1A7982ULL,
    0x3C1629830AF06E3FULL, 0x9165EBFD427E5A8EULL, 0xB5DD81794CEEAA5CULL, 0x0DE8F15A7834F219ULL,
    0x70BD98EDE3DD5D25ULL, 0xACCC9CA9328A8950ULL, 0x56664EDA1945CA28ULL, 0x221DB34C0F8859AEULL,
    0x26DBD637FA98970DULL, 0x1ACDFFB4F068F932ULL, 0x4585254F64090FA0ULL, 0x72DE245E17D53AFAULL,
    0x1546B25D7C546CF4ULL, 0x207E0FFFFB803E71ULL, 0xFAAAD2732BCF4378ULL, 0xB462DFAE36EA17BDULL,
    0xCF926FD1AC1B11FDULL, 0xE0672DC7DBA7BA4AULL, 0xD3FA49AD5D6B41B3ULL, 0x8BA81449B216A3BCULL,
    0x14F9EC8A0650D115ULL, 0x40FC1EE3EB1D7CE2ULL, 0x23A2ED9B758CE44FULL, 0x782C521B14FDDC7EULL,
    0x1C68267CF170504EULL, 0xBCF31558C1CA96E6ULL, 0xA781B43B4BA6D235ULL, 0xF6FD7DFE29FF0C80ULL,
    0xB0A4BAD5C3FAD91EULL, 0xD199F51EA963266CULL, 0x414340349119C103ULL, 0x5405F269ED4DADF7ULL,
    0xABD61BB649969DCDULL, 0x6813DBEAE7BDC3C8ULL, 0x65FB2AB09F8931D1ULL, 0xF1E7FAE152E3181DULL,
    0xC1A67CEF5A2339DAULL, 0x7A4FEEA8E0F5BBA1ULL, 0x1E0B9ACF05783791ULL, 0x5B8EBF8061713831ULL,
    0x80E53CDBCB3AF8D9ULL, 0x7E898BD315E57502ULL, 0xC6BCFBF0213F2D47ULL, 0x95A38E86B76E942DULL,
    0x092E94218D243CBAULL, 0x8339DEBF453622E7ULL, 0xB11BE402B9FE64FFULL, 0x57D9100D634177C9ULL,
    0xCC4E8DB52217CBC3ULL, 0x3B0CAE9C71EC7AA2ULL, 0xFB158CA451CBFE99ULL, 0x2B33276D82AC6514ULL,
    0x01BF5ED77A04BDE1ULL, 0xC5601994AF33F779ULL, 0x75C4A3416CC92E67ULL, 0xF3844652A6EB7FC2ULL,
    0x3487E375FDD0EF64ULL, 0x18AE430704609EEDULL, 0x4D14EFB993298EFBULL, 0x815A620CB13E4538ULL,
    0x125C354207487869ULL, 0x9EEEA614CE42CF48ULL, 0xCE2D3106D61FAC1CULL, 0xBBE99247BAD6827BULL,
    0x071A871F7B1C149DULL, 0x2E4A1CC10DB81656ULL, 0x77A71FF298C149B8ULL, 0x06A5D9C80118A97CULL,
    0xAD73C27E488E34B1ULL, 0x443A7B981E0DB241ULL, 0xE3BBCFA355AB6074ULL, 0x0AF276450328E684ULL,
    0x73617A896DD1871BULL, 0x58525DE4EF7DE20FULL, 0xB7BE3DCAB8E6CD83ULL, 0x19111DD07E64230CULL,
    0x842359A03E2A367AULL, 0x103F89F1F3401FB6ULL, 0xDC710444D157D475ULL, 0xB835702334DA5845ULL,
    0x4320FC876511A6DCULL, 0xD026ABC9D3679B8DULL, 0x17250EEE885C0B2BULL, 0x90DAB52A387AE76FULL,
    0x31FED8D972C49C26ULL, 0x89CBA8FA461EC463ULL, 0x2FF5421677BCABB7ULL, 0x396F122F85E41D7DULL,
    0xA09B332430BAC6A8ULL, 0xC888E8CED7070560ULL, 0xAEAF201AC682EE8FULL, 0x1180D7268944A257ULL,
    0xF058A43628E7A5FCULL, 0xBD4C4B8FBBCE2B07ULL, 0xA1246DF34ABE7B49ULL, 0x7D5569B79BE9AF3CULL,
    0xA9B5A705BD9EFA12ULL, 0xDB6B835BAA4BC0E8ULL, 0x05793BAC8F147342ULL, 0x21C1512881848390ULL,
    0xFDB0556C50D357E5ULL, 0x613D4FCB6A99FF72ULL, 0x03DCE2648E0CDA3EULL, 0xE949B9E6568386F0ULL,
    0xFC0F0BBB2AD7EA04ULL, 0x6A70675913B5A417ULL, 0x7F36D5046FE1C8E3ULL, 0x0C57AF8D02304FF8ULL,
    0x32223ABDFCC84618ULL, 0x0891CAF6F720815BULL, 0xA63EEAEC31A26FD4ULL, 0x2507345374944D33ULL,
    0x49D28AC266394058ULL, 0xF5219F9AA7F3D6BEULL, 0x2D96FEA583B4CC68ULL, 0x5A31E1571B7585D0ULL,
    0x8ED12FE53D02D0FEULL, 0xDFADE6205F5B0E4BULL, 0x4CABB16EE92D331AULL, 0x04C6657BF510CEA3ULL,
    0xD73C2CD6A87B8F10ULL, 0xE1D87310A1A307ABULL, 0x6CD5BE9112AD0D6BULL, 0x97C032354366F3F2ULL,
    0xD4E0CEB22677552EULL, 0x0000000000000000ULL, 0x29509BDE76A402CBULL, 0xC27A9E8BD42FE3E4ULL,
    0x5EF7842CEE654B73ULL, 0xAF107ECDBC86536EULL, 0x3FCACBE784FCB401ULL, 0xD55F90655C73E8CFULL,
    0xE6C2F40FDABF1336ULL, 0xE8F6E7312C873B11ULL, 0xEB2A0555A28BE12FULL, 0xE4A148BC2EB774E9ULL,
    0x9B979DB84156BC0AULL, 0x6EB60222E6A56AB4ULL, 0x87FFBBC4B026EC44ULL, 0xC703A5275B3B90A6ULL,
    0x47E699FC9001687FULL, 0x9C8D1AA73A4AA897ULL, 0x7CEA3760E1ED12DDULL, 0x4EC80DDD1D2554C5ULL,
    0x13E36B957D4CC588ULL, 0x5D2B66486069914DULL, 0x92B90999CC7280B0ULL, 0x517CC9C56259DEB5ULL,
    0xC937B619AD03B881ULL, 0xEC30824AD997F5B2ULL, 0xA45D565FC5AA080BULL, 0xD6837201D27F32F1ULL,
    0x635EF3789E9198ADULL, 0x531F75769651B96AULL, 0x4F77530A6721E924ULL, 0x486DD4151C3DFDB9ULL,
    0x5F48DAFB9461F692ULL, 0x375B011173DC355AULL, 0x3DA9775470F4D3DEULL, 0x8D0DCD81B30E0AC0ULL,
    0x36E45FC609D888BBULL, 0x55BAACBE97491016ULL, 0x8CB29356C90AB721ULL, 0x76184125E2C5F459ULL,
    0x99F4210BB55EDBD5ULL, 0x6F095CF59CA1D755ULL, 0x9F51F8C3B44672A9ULL, 0x3538BDA287D45285ULL,
    0x50C39712185D6354ULL, 0xF23B1885DCEFC223ULL, 0x79930CCC6EF9619FULL, 0xED8FDC9DA3934853ULL,
    0xCB540AAA590BDF5EULL, 0x5C94389F1A6D2CACULL, 0xE77DAAD8A0BBAED7ULL, 0x28EFC5090CA0BF2AULL,
    0xBF2FF73C4FC64CD8ULL, 0xB37858B14DF60320ULL, 0xF8C96EC0DFC724A7ULL, 0x828680683F329F06ULL,
    0x941CD051CD6A29CCULL, 0xC3C5C05CAE2B5E05ULL, 0xB601631DC2E27062ULL, 0xC01922382027843BULL,
    0x24B86A840E90F0D2ULL, 0xD245177A276FFC52ULL, 0x0F8B4DE98C3C95C6ULL, 0x3E759530FEF809E0ULL,
    0x0B4D2892792C5B65ULL, 0xC4DF4743D5374A98ULL, 0xA5E20888BFAEB5EAULL, 0xBA56CC90C0D23F9AULL,
    0x38D04CF8FFE0A09CULL, 0x62E1ADAFE495254CULL, 0x0263BCB3F40867DFULL, 0xCAEB547D230F62BFULL,
    0x6082111C109D4293ULL, 0xDAD4DD8CD04F7D09ULL, 0xEFEC602E579B2F8CULL, 0x1FB4C4187F7C8A70ULL,
    0xFFD3E9DFA4DB303AULL, 0x7BF0B07F9AF10640ULL, 0xF49EC14DDDF76B5FULL, 0x8F6E713247066D1FULL,
    0x339D646A86CCFBF9ULL, 0x64447467E58D8C30ULL, 0x2C29A072F9B07189ULL, 0xD8B7613F24471AD6ULL,
    0x6627C8D41185EBEFULL, 0xA347D140BEB61C96ULL, 0xDE12B8F7255FB3AAULL, 0x9D324470404E1576ULL,
    0x9306574EB6763D51ULL, 0xA80AF9D2C79A47F3ULL, 0x859C0777442E8B9BULL, 0x69AC853D9DB97E29ULL },
{
    0xC3407DFC2DE6377EULL, 0x5B9E93EEA4256F77ULL, 0xADB58FDD50C845E0ULL, 0x5219FF11A75BED86ULL,
    0x356B61CFD90B1DE9ULL, 0xFB8F406E25ABE037ULL, 0x7A5A0231C0F60796ULL, 0x9D3CD216E1F5020BULL,
    0x0C6550FB6B48D8F3ULL, 0xF57508C427FF1C62ULL, 0x4AD35FFA71CB407DULL, 0x6290A2DA1666AA6DULL,
    0xE284EC2349355F9FULL, 0xB3C307C53D7C84ECULL, 0x05E23C0468365A02ULL, 0x190BAC4D6C9EBFA8ULL,
    0x94BBBEE9E28B80FAULL, 0xA34FC777529CB9B5ULL, 0xCC7B39F095BCD978ULL, 0x2426ADDB0CE532E3ULL,
    0x7E79329312CE4FC7ULL, 0xAB09A72EEBEC2917ULL, 0xF8D15499F6B9D6C2ULL, 0x1A55B8BABF8C895DULL,
    0xDB8ADD17FB769A85ULL, 0xB57F2F368658E81BULL, 0x8ACD36F18F3F41F6ULL, 0x5CE3B7BBA50F11D3ULL,
    0x114DCC14D5EE2F0AULL, 0xB91A7FCDED1030E8ULL, 0x81D5425FE55DE7A1ULL, 0xB6213BC1554ADEEEULL,
    0x80144EF95F53F5F2ULL, 0x1E7688186DB4C10CULL, 0x3B912965DB5FE1BCULL, 0xC281715A97E8252DULL,
    0x54A5D7E21C7F8171ULL, 0x4B12535CCBC5522EULL, 0x1D289CEFBEA6F7F9ULL, 0x6EF5F2217D2E729EULL,
    0xE6A7DC819B0D17CEULL, 0x1B94B41C05829B0EULL, 0x33D7493C622F711EULL, 0xDCF7F942FA5CE421ULL,
    0x600FBA8B7F7A8ECBULL, 0x46B60F011A83988EULL, 0x235B898E0DCF4C47ULL, 0x957AB24F588592A9ULL,
    0x4354330572B5C28CULL, 0xA5F3EF84E9B8D542ULL, 0x8C711E02341B2D01ULL, 0x0B1874AE6A62A657ULL,
    0x1213D8E306FC19FFULL, 0xFE6D7C6A4D9DBA35ULL, 0x65ED868F174CD4C9ULL, 0x88522EA0E6236550ULL,
    0x899322065C2D7703ULL, 0xC01E690BFEF4018BULL, 0x915982ED8ABDDAF8ULL, 0xBE675B98EC3A4E4CULL,
    0xA996BF7F82F00DB1ULL, 0xE1DAF8D49A27696AULL, 0x2EFFD5D3DC8986E7ULL, 0xD153A51F2B1A2E81ULL,
    0x18CAA0EBD690ADFBULL, 0x390E3134B243C51AULL, 0x2778B92CDFF70416ULL, 0x029F1851691C24A6ULL,
    0x5E7CAFEACC133575ULL, 0xFA4E4CC89FA5F264ULL, 0x5A5F9F481E2B7D24ULL, 0x484C47AB18D764DBULL,
    0x400A27F2A1A7F479ULL, 0xAEEB9B2A83DA7315ULL, 0x721C626879869734ULL, 0x042330A2D2384851ULL,
    0x85F672FD3765AFF0ULL, 0xBA446B3A3E02061DULL, 0x73DD6ECEC3888567ULL, 0xFFAC70CCF793A866ULL,
    0xDFA9EDB5294ED2D4ULL, 0x6C6AEA7014325638ULL, 0x834A5A0E8C41C307ULL, 0xCDBA35562FB2CB2BULL,
    0x0AD97808D06CB404ULL, 0x0F3B440CB85AEE06ULL, 0xE5F9C876481F213BULL, 0x98DEEE1289C35809ULL,
    0x59018BBFCD394BD1ULL, 0xE01BF47220297B39ULL, 0xDE68E1139340C087ULL, 0x9FA3CA4788E926ADULL,
    0xBB85679C840C144EULL, 0x53D8F3B71D55FFD5ULL, 0x0DA45C5DD146CAA0ULL, 0x6F34FE87C72060CDULL,
    0x57FBC315CF6DB784ULL, 0xCEE421A1FCA0FDDEULL, 0x3D2D0196607B8D4BULL, 0x642C8A29AD42C69AULL,
    0x14AFF010BDD87508ULL, 0xAC74837BEAC657B3ULL, 0x3216459AD821634DULL, 0x3FB219C70967A9EDULL,
    0x06BC28F3BB246CF7ULL, 0xF2082C9126D562C6ULL, 0x66B39278C45EE23CULL, 0xBD394F6F3F2878B9ULL,
    0xFD33689D9E8F8CC0ULL, 0x37F4799EB017394FULL, 0x108CC0B26FE03D59ULL, 0xDA4BD1B1417888D6ULL,
    0xB09D1332EE6EB219ULL, 0x2F3ED975668794B4ULL, 0x58C0871977375982ULL, 0x7561463D78ACE990ULL,
    0x09876CFF037E82F1ULL, 0x7FB83E35A8C05D94ULL, 0x26B9B58A65F91645ULL, 0xEF20B07E9873953FULL,
    0x3148516D0B3355B8ULL, 0x41CB2B541BA9E62AULL, 0x790416C613E43163ULL, 0xA011D380818E8F40ULL,
    0x3A5025C36151F3EFULL, 0xD57095BDF92266D0ULL, 0x498D4B0DA2D97688ULL, 0x8B0C3A57353153A5ULL,
    0x21C491DF64D368E1ULL, 0x8F2F0AF5E7091BF4ULL, 0x2DA1C1240F9BB012ULL, 0xC43D59A92CCC49DAULL,
    0xBFA6573E56345C1FULL, 0x828B56A8364FD154ULL, 0x9A41F643E0DF7CAFULL, 0xBCF843C985266AEAULL,
    0x2B1DE9D7B4BFDCE5ULL, 0x20059D79DEDD7AB2ULL, 0x6DABE6D6AE3C446BULL, 0x45E81BF6C991AE7BULL,
    0x6351AE7CAC68B83EULL, 0xA432E32253B6C711ULL, 0xD092A9B991143CD2ULL, 0xCAC711032E98B58FULL,
    0xD8D4C9E02864AC70ULL, 0xC5FC550F96C25B89ULL, 0xD7EF8DEC903E4276ULL, 0x67729EDE7E50F06FULL,
    0xEAC28C7AF045CF3DULL, 0xB15C1F945460A04AULL, 0x9CFDDEB05BFB1058ULL, 0x93C69ABCE3A1FE5EULL,
    0xEB0380DC4A4BDD6EULL, 0xD20DB1E8F8081874ULL, 0x229A8528B7C15E14ULL, 0x44291750739FBC28ULL,
    0xD3CCBD4E42060A27ULL, 0xF62B1C33F4ED2A97ULL, 0x86A8660AE4779905ULL, 0xD62E814A2A305025ULL,
    0x477703A7A08D8ADDULL, 0x7B9B0E977AF815C5ULL, 0x78C51A60A9EA2330ULL, 0xA6ADFB733AAAE3B7ULL,
    0x97E5AA1E3199B60FULL, 0x0000000000000000ULL, 0xF4B404629DF10E31ULL, 0x5564DB44A6719322ULL,
    0x9207961A59AFEC0DULL, 0x9624A6B88B97A45CULL, 0x363575380A192B1CULL, 0x2C60CD82B595A241ULL,
    0x7D272664C1DC7932ULL, 0x7142769FAA94A1C1ULL, 0xA1D0DF263B809D13ULL, 0x1630E841D4C451AEULL,
    0xC1DF65AD44FA13D8ULL, 0x13D2D445BCF20BACULL, 0xD915C546926ABE23ULL, 0x38CF3D92084DD749ULL,
    0xE766D0272103059DULL, 0xC7634D5EFFDE7F2FULL, 0x077D2455012A7EA4ULL, 0xEDBFA82FF16FB199ULL,
    0xAF2A978C39D46146ULL, 0x42953FA3C8BBD0DFULL, 0xCB061DA59496A7DCULL, 0x25E7A17DB6EB20B0ULL,
    0x34AA6D6963050FBAULL, 0xA76CF7D580A4F1E4ULL, 0xF7EA10954EE338C4ULL, 0xFCF2643B24819E93ULL,
    0xCF252D0746AEEF8DULL, 0x4EF06F58A3F3082CULL, 0x563ACFB37563A5D7ULL, 0x5086E740CE47C920ULL,
    0x2982F186DDA3F843ULL, 0x87696AAC5E798B56ULL, 0x5D22BB1D1F010380ULL, 0x035E14F7D31236F5ULL,
    0x3CEC0D30DA759F18ULL, 0xF3C920379CDB7095ULL, 0xB8DB736B571E22BBULL, 0xDD36F5E44052F672ULL,
    0xAAC8AB8851E23B44ULL, 0xA857B3D938FE1FE2ULL, 0x17F1E4E76ECA43FDULL, 0xEC7EA4894B61A3CAULL,
    0x9E62C6E132E734FEULL, 0xD4B1991B432C7483ULL, 0x6AD6C283AF163ACFULL, 0x1CE9904904A8E5AAULL,
    0x5FBDA34C761D2726ULL, 0xF910583F4CB7C491ULL, 0xC6A241F845D06D7CULL, 0x4F3163FE19FD1A7FULL,
    0xE99C988D2357F9C8ULL, 0x8EEE06535D0709A7ULL, 0x0EFA48AA0254FC55ULL, 0xB4BE23903C56FA48ULL,
    0x763F52CAABBEDF65ULL, 0xEEE1BCD8227D876CULL, 0xE345E085F33B4DCCULL, 0x3E731561B369BBBEULL,
    0x2843FD2067ADEA10ULL, 0x2ADCE5710EB1CEB6ULL, 0xB7E03767EF44CCBDULL, 0x8DB012A48E153F52ULL,
    0x61CEB62DC5749C98ULL, 0xE85D942B9959EB9BULL, 0x4C6F7709CAEF2C8AULL, 0x84377E5B8D6BBDA3ULL,
    0x30895DCBB13D47EBULL, 0x74A04A9BC2A2FBC3ULL, 0x6B17CE251518289CULL, 0xE438C4D0F2113368ULL,
    0x1FB784BED7BAD35FULL, 0x9B80FAE55AD16EFCULL, 0x77FE5E6C11B0CD36ULL, 0xC858095247849129ULL,
    0x08466059B97090A2ULL, 0x01C10CA6BA0E1253ULL, 0x6988D6747C040C3AULL, 0x6849DAD2C60A1E69ULL,
    0x5147EBE67449DB73ULL, 0xC99905F4FD8A837AULL, 0x991FE2B433CD4A5AULL, 0xF09734C04FC94660ULL,
    0xA28ECBD1E892ABE6ULL, 0xF1563866F5C75433ULL, 0x4DAE7BAF70E13ED9ULL, 0x7CE62AC27BD26B61ULL,
    0x70837A39109AB392ULL, 0x90988E4B30B3C8ABULL, 0xB2020B63877296BFULL, 0x156EFCB607D6675BULL },
{
    0xE63F55CE97C331D0ULL, 0x25B506B0015BBA16ULL, 0xC8706E29E6AD9BA8ULL, 0x5B43D3775D521F6AULL,
    0x0BFA3D577035106EULL, 0xAB95FC172AFB0E66ULL, 0xF64B63979E7A3276ULL, 0xF58B4562649DAD4BULL,
    0x48F7C3DBAE0C83F1ULL, 0xFF31916642F5C8C5ULL, 0xCBB048DC1C4A0495ULL, 0x66B8F83CDF622989ULL,
    0x35C130E908E2B9B0ULL, 0x7C761A61F0B34FA1ULL, 0x3601161CF205268DULL, 0x9E54CCFE2219B7D6ULL,
    0x8B7D90A538940837ULL, 0x9CD403588EA35D0BULL, 0xBC3C6FEA9CCC5B5AULL, 0xE5FF733B6D24AEEDULL,
    0xCEED22DE0F7EB8D2ULL, 0xEC8581CAB1AB545EULL, 0xB96105E88FF8E71DULL, 0x8CA03501871A5EADULL,
    0x76CCCE65D6DB2A2FULL, 0x5883F582A7B58057ULL, 0x3F7BE4ED2E8ADC3EULL, 0x0FE7BE06355CD9C9ULL,
    0xEE054E6C1D11BE83ULL, 0x1074365909B903A6ULL, 0x5DDE9F80B4813C10ULL, 0x4A770C7D02B6692CULL,
    0x5379C8D5D7809039ULL, 0xB4067448161ED409ULL, 0x5F5E5026183BD6CDULL, 0xE898029BF4C29DF9ULL,
    0x7FB63C940A54D09CULL, 0xC5171F897F4BA8BCULL, 0xA6F28DB7B31D3D72ULL, 0x2E4F3BE7716EAA78ULL,
    0x0D6771A099E63314ULL, 0x82076254E41BF284ULL, 0x2F0FD2B42733DF98ULL, 0x5C9E76D3E2DC49F0ULL,
    0x7AEB569619606CDBULL, 0x83478B07B2468764ULL, 0xCFADCB8D5923CD32ULL, 0x85DAC7F05B95A41EULL,
    0xB5469D1B4043A1E9ULL, 0xB821ECBBD9A592FDULL, 0x1B8E0B0E798C13C8ULL, 0x62A57B6D9A0BE02EULL,
    0xFCF1B793B81257F8ULL, 0x9D94EA0BD8FE28EBULL, 0x4CEA408AEB654A56ULL, 0x23284A47E888996CULL,
    0x2D8F1D128B893545ULL, 0xF4CBAC3132C0D8ABULL, 0xBD7C86B9CA912EBAULL, 0x3A268EEF3DBE6079ULL,
    0xF0D62F6077A9110CULL, 0x2735C916ADE150CBULL, 0x89FD5F03942EE2EAULL, 0x1ACEE25D2FD16628ULL,
    0x90F39BAB41181BFFULL, 0x430DFE8CDE39939FULL, 0xF70B8AC4C8274796ULL, 0x1C53AEAAC6024552ULL,
    0x13B410ACF35E9C9BULL, 0xA532AB4249FAA24FULL, 0x2B1251E5625A163FULL, 0xD7E3E676DA4841C7ULL,
    0xA7B264E4E5404892ULL, 0xDA8497D643AE72D3ULL, 0x861AE105A1723B23ULL, 0x38A6414991048AA4ULL,
    0x6578DEC92585B6B4ULL, 0x0280CFA6ACBAEADDULL, 0x88BDB650C273970AULL, 0x9333BD5EBBFF84C2ULL,
    0x4E6A8F2C47DFA08BULL, 0x321C954DB76CEF2AULL, 0x418D312A72837942ULL, 0xB29B38BFFFCDF773ULL,
    0x6C022C38F90A4C07ULL, 0x5A033A240B0F6A8AULL, 0x1F93885F3CE5DA6FULL, 0xC38A537E96988BC6ULL,
    0x39E6A81AC759FF44ULL, 0x29929E43CEE0FCE2ULL, 0x40CDD87924DE0CA2ULL, 0xE9D8EBC8A29FE819ULL,
    0x0C2798F3CFBB46F4ULL, 0x55E484223E53B343ULL, 0x4650948ECD0D2FD8ULL, 0x20E86CB2126F0651ULL,
    0x6D42C56BAF5739E7ULL, 0xA06FC1405ACE1E08ULL, 0x7BABBFC54F3D193BULL, 0x424D17DF8864E67FULL,
    0xD8045870EF14980EULL, 0xC6D7397C85AC3781ULL, 0x21A885E1443273B1ULL, 0x67F8116F893F5C69ULL,
    0x24F5EFE35706CFF6ULL, 0xD56329D076F2AB1AULL, 0x5E1EB9754E66A32DULL, 0x28D2771098BD8902ULL,
    0x8F6013F47DFDC190ULL, 0x17A993FDB637553CULL, 0xE0A219397E1012AAULL, 0x786B9930B5DA8606ULL,
    0x6E82E39E55B0A6DAULL, 0x875A0856F72F4EC3ULL, 0x3741FF4FA458536DULL, 0xAC4859B3957558FCULL,
    0x7EF6D5C75C09A57CULL, 0xC04A758B6C7F14FBULL, 0xF9ACDD91AB26EBBFULL, 0x7391A467C5EF9668ULL,
    0x335C7C1EE1319ACAULL, 0xA91533B18641E4BBULL, 0xE4BF9A683B79DB0DULL, 0x8E20FAA72BA0B470ULL,
    0x51F907737B3A7AE4ULL, 0x2268A314BED5EC8CULL, 0xD944B123B949EDEEULL, 0x31DCB3B84D8B7017ULL,
    0xD3FE65279F218860ULL, 0x097AF2F1DC8FFAB3ULL, 0x9B09A6FC312D0B91ULL, 0xCC6DED78A3C4520FULL,
    0x3481D9BA5EBFCC50ULL, 0x4F2A667F1182D56BULL, 0xDFD9FDD4509ACE94ULL, 0x26752045FBBC252BULL,
    0xBFFC491F662BC467ULL, 0xDD593272FC202449ULL, 0x3CBBC218D46D4303ULL, 0x91B372F817456E1FULL,
    0x681FAF69BC6385A0ULL, 0xB686BBEEBAA43ED4ULL, 0x1469B5084CD0CA01ULL, 0x98C98009CBCA94ACULL,
    0x6438379A73D8C354ULL, 0xC2CABA2DC0C5FE26ULL, 0x3E3B0DBE78D7A9DEULL, 0x50B9EE202D670F04ULL,
    0x4590B27B37EAB0E5ULL, 0x6025B4CB36B10AF3ULL, 0xFB2C1237079C0162ULL, 0xA12F28130C936BE8ULL,
    0x4B37E52E54EB1CCCULL, 0x083A1BA28AD28F53ULL, 0xC10A9CD83A22611BULL, 0x9F1425AD7444C236ULL,
    0x069D4CF7E9D3237AULL, 0xEDC56899E7F621BEULL, 0x778C273680865FCFULL, 0x309C5AEB1BD605F7ULL,
    0x8DE0DC52D1472B4DULL, 0xF8EC34C2FD7B9E5FULL, 0xEA18CD3D58787724ULL, 0xAAD515447CA67B86ULL,
    0x9989695A9D97E14CULL, 0x0000000000000000ULL, 0xF196C63321F464ECULL, 0x71116BC169557CB5ULL,
    0xAF887F466F92C7C1ULL, 0x972E3E0FFE964D65ULL, 0x190EC4A8D536F915ULL, 0x95AEF1A9522CA7B8ULL,
    0xDC19DB21AA7D51A9ULL, 0x94EE18FA0471D258ULL, 0x8087ADF248A11859ULL, 0xC457F6DA2916DD5CULL,
    0xFA6CFB6451C17482ULL, 0xF256E0C6DB13FBD1ULL, 0x6A9F60CF10D96F7DULL, 0x4DAAA9D9BD383FB6ULL,
    0x03C026F5FAE79F3DULL, 0xDE99148706C7BB74ULL, 0x2A52B8B6340763DFULL, 0x6FC20ACD03EDD33AULL,
    0xD423C08320AFDEFAULL, 0xBBE1CA4E23420DC0ULL, 0x966ED75CA8CB3885ULL, 0xEB58246E0E2502C4ULL,
    0x055D6A021334BC47ULL, 0xA47242111FA7D7AFULL, 0xE3623FCC84F78D97ULL, 0x81C744A11EFC6DB9ULL,
    0xAEC8961539CFB221ULL, 0xF31609958D4E8E31ULL, 0x63E5923ECC5695CEULL, 0x47107DDD9B505A38ULL,
    0xA3AFE7B5A0298135ULL, 0x792B7063E387F3E6ULL, 0x0140E953565D75E0ULL, 0x12F4F9FFA503E97BULL,
    0x750CE8902C3CB512ULL, 0xDBC47E8515F30733ULL, 0x1ED3610C6AB8AF8FULL, 0x5239218681DDE5D9ULL,
    0xE222D69FD2AAF877ULL, 0xFE71783514A8BD25ULL, 0xCAF0A18F4A177175ULL, 0x61655D9860EC7F13ULL,
    0xE77FBC9DC19E4430ULL, 0x2CCFF441DDD440A5ULL, 0x16E97AAEE06A20DCULL, 0xA855DAE2D01C915BULL,
    0x1D1347F9905F30B2ULL, 0xB7C652BDECF94B34ULL, 0xD03E43D265C6175DULL, 0xFDB15EC0EE4F2218ULL,
    0x57644B8492E9599EULL, 0x07DDA5A4BF8E569AULL, 0x54A46D71680EC6A3ULL, 0x5624A2D7C4B42C7EULL,
    0xBEBCA04C3076B187ULL, 0x7D36F332A6EE3A41ULL, 0x3B6667BC6BE31599ULL, 0x695F463AEA3EF040ULL,
    0xAD08B0E0C3282D1CULL, 0xB15B1E4A052A684EULL, 0x44D05B2861B7C505ULL, 0x15295C5B1A8DBFE1ULL,
    0x744C01C37A61C0F2ULL, 0x59C31CD1F1E8F5B7ULL, 0xEF45A73F4B4CCB63ULL, 0x6BDF899C46841A9DULL,
    0x3DFB2B4B823036E3ULL, 0xA2EF0EE6F674F4D5ULL, 0x184E2DFB836B8CF5ULL, 0x1134DF0A5FE47646ULL,
    0xBAA1231D751F7820ULL, 0xD17EAA81339B62BDULL, 0xB01BF71953771DAEULL, 0x849A2EA30DC8D1FEULL,
    0x705182923F080955ULL, 0x0EA757556301AC29ULL, 0x041D83514569C9A7ULL, 0x0ABAD4042668658EULL,
    0x49B72A88F851F611ULL, 0x8A3D79F66EC97DD7ULL, 0xCD2D042BF59927EFULL, 0xC930877AB0F0EE48ULL,
    0x9273540DEDA2F122ULL, 0xC797D02FD3F14261ULL, 0xE1E2F06A284D674AULL, 0xD2BE8C74C97CFD80ULL,
    0x9A494FAF67707E71ULL, 0xB3DBD1ECA9908293ULL, 0x72D14D3493B2E388ULL, 0xD6A30F258C153427ULL }
};

static const uint64_t C16[12][8] = {
{
    0xDD806559F2A64507ULL, 0x05767436CC744D23ULL, 0xA2422A08A460D315ULL, 0x4B7CE09192676901ULL,
    0x714EB88D7585C4FCULL, 0x2F6A76432E45D016ULL, 0xEBCB2F81C0657C1FULL, 0xB1085BDA1ECADAE9ULL },
{
    0xE679047021B19BB7ULL, 0x55DDA21BD7CBCD56ULL, 0x5CB561C2DB0AA7CAULL, 0x9AB5176B12D69958ULL,
    0x61D55E0F16B50131ULL, 0xF3FEEA720A232B98ULL, 0x4FE39D460F70B5D7ULL, 0x6FA3B58AA99D2F1AULL },
{
    0x991E96F50ABA0AB2ULL, 0xC2B6F443867ADB31ULL, 0xC1C93A376062DB09ULL, 0xD3E20FE490359EB1ULL,
    0xF2EA7514B1297B7BULL, 0x06F15E5F529C1F8BULL, 0x0A39FC286A3D8435ULL, 0xF574DCAC2BCE2FC7ULL },
{
    0x220CBEBC84E3D12EULL, 0x3453EAA193E837F1ULL, 0xD8B71333935203BEULL, 0xA9D72C82ED03D675ULL,
    0x9D721CAD685E353FULL, 0x488E857E335C3C7DULL, 0xF948E1A05D71E4DDULL, 0xEF1FDFB3E81566D2ULL },
{
    0x601758FD7C6CFE57ULL, 0x7A56A27EA9EA63F5ULL, 0xDFFF00B723271A16ULL, 0xBFCD1747253AF5A3ULL,
    0x359E35D7800FFFBDULL, 0x7F151C1F1686104AULL, 0x9A3F410C6CA92363ULL, 0x4BEA6BACAD474799ULL },
{
    0xFA68407A46647D6EULL, 0xBF71C57236904F35ULL, 0x0AF21F66C2BEC6B6ULL, 0xCFFAA6B71C9AB7B4ULL,
    0x187F9AB49AF08EC6ULL, 0x2D66C4F95142A46CULL, 0x6FA4C33B7A3039C0ULL, 0xAE4FAEAE1D3AD3D9ULL },
{
    0x8886564D3A14D493ULL, 0x3517454CA23C4AF3ULL, 0x06476983284A0504ULL, 0x0992ABC52D822C37ULL,
    0xD3473E33197A93C9ULL, 0x399EC6C7E6BF87C9ULL, 0x51AC86FEBF240954ULL, 0xF4C70E16EEAAC5ECULL },
{
    0xA47F0DD4BF02E71EULL, 0x36ACC2355951A8D9ULL, 0x69D18D2BD1A5C42FULL, 0xF4892BCB929B0690ULL,
    0x89B4443B4DDBC49AULL, 0x4EB7F8719C36DE1EULL, 0x03E7AA020C6E4141ULL, 0x9B1F5B424D93C9A7ULL },
{
    0x7261445183235ADBULL, 0x0E38DC92CB1F2A60ULL, 0x7B2B8A9AA6079C54ULL, 0x800A440BDBB2CEB1ULL,
    0x3CD955B7E00D0984ULL, 0x3A7D3A1B25894224ULL, 0x944C9AD8EC165FDEULL, 0x378F5A541631229BULL },
{
    0x74B4C7FB98459CEDULL, 0x3698FAD1153BB6C3ULL, 0x7A1E6C303B7652F4ULL, 0x9FE76702AF69334BULL,
    0x1FFFE18A1B336103ULL, 0x8941E71CFF8A78DBULL, 0x382AE548B2E4F3F3ULL, 0xABBEDEA680056F52ULL },
{
    0x6BCAA4CD81F32D1BULL, 0xDEA2594AC06FD85DULL, 0xEFBACD1D7D476E98ULL, 0x8A1D71EFEA48B9CAULL,
    0x2001802114846679ULL, 0xD8FA6BBBEBAB0761ULL, 0x3002C6CD635AFE94ULL, 0x7BCD9ED0EFC889FBULL },
{
    0x48BC924AF11BD720ULL, 0xFAF417D5D9B21B99ULL, 0xE71DA4AA88E12852ULL, 0x5D80EF9D1891CC86ULL,
    0xF82012D430219F9BULL, 0xCDA43C32BCDF1D77ULL, 0xD21380B00449B17AULL, 0x378EE767F11631BAULL }
};

static void SPLX(uint64_t *out, const uint64_t *a, const uint64_t *b)
{
    uint64_t tmp[8];
    int i;

    for (i = 7; i >= 0; i--) {
        tmp[i] = a[i] ^ b[i];
    }

    for (i = 7; i >= 0; i--) {
        out[i] = gostr3411_2012_ext_table[0][(tmp[0] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[1][(tmp[1] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[2][(tmp[2] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[3][(tmp[3] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[4][(tmp[4] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[5][(tmp[5] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[6][(tmp[6] >> (i * 8)) & 0xFF];
        out[i] ^= gostr3411_2012_ext_table[7][(tmp[7] >> (i * 8)) & 0xFF];
    }
}

static void G(uint64_t* h, uint64_t* m, uint64_t* N)
{
    uint64_t K[8];
    uint64_t T[8];
    int i;

    SPLX(K, h, N);
    SPLX(T, K, m);
    SPLX(K, K, C16[0]);

    for (i = 1; i < 12; i++) {
        SPLX(T, K, T);
        SPLX(K, K, C16[i]);
    }

    for (i = 7; i >= 0; i--) {
        h[i] ^= T[i] ^ K[i] ^ m[i];
    }
}

static void gostr3411_compress(GostR3411Ctx* ctx, const uint8_t* input, uint64_t bitlength)
{
    uint64_t M[8];
    uint64_t cf;
    size_t i;

    for (i = 0; i < 8; i++) {
        M[i] = LE_READ_UINT64(input + i * 8);
    }

    G(ctx->state, M, ctx->total_length);
    ctx->total_length[0] += bitlength;
    if (ctx->total_length[0] < bitlength) {
        for (i = 1; i < 8; i++)
        {
            ctx->total_length[i]++;
            if (ctx->total_length[i] != 0) {
                break;
            }
        }
    }

    cf = 0;
    ctx->sigma[0] += M[0];
    for (i = 1; i < 8; i++) {
        if (ctx->sigma[i - 1] != M[i - 1]) {
            cf = (ctx->sigma[i - 1] < M[i - 1]);
        }
        ctx->sigma[i] += M[i] + cf;
    }
}

GostR3411Ctx* gostr3411_alloc(GostR3411Variant variant)
{
    int ret = RET_OK;
    GostR3411Ctx* ctx = NULL;

    CALLOC_CHECKED(ctx, sizeof(GostR3411Ctx));

    switch (variant) {
    case GOSTR3411_2012_VARIANT_256:
        memset(ctx->state, 1, 64);
        break;
    case GOSTR3411_2012_VARIANT_512:
        //memset(ctx->state, 0, 64);
        break;
    default:
        SET_ERROR(RET_INVALID_PARAM);
    }

    ctx->variant = variant;

cleanup:

    if (ret != RET_OK) {
        gostr3411_free(ctx);
        ctx = NULL;
    }

    return ctx;
}


GostR3411Ctx* gostr3411_copy_with_alloc(const GostR3411Ctx* ctx)
{
    GostR3411Ctx* out = NULL;
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CALLOC_CHECKED(out, sizeof(GostR3411Ctx));
    memcpy(out, ctx, sizeof(GostR3411Ctx));

cleanup:

    return out;
}

int gostr3411_update(GostR3411Ctx* ctx, const ByteArray* data)
{
    int ret = RET_OK;
    const uint8_t* dataptr;
    size_t datalen;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(data != NULL);

    dataptr = data->buf;
    datalen = data->len;

    if (ctx->block_ind) {
        if (datalen < (64 - ctx->block_ind)) {
            memcpy(ctx->block + ctx->block_ind, dataptr, datalen);
            ctx->block_ind += datalen;
            goto cleanup;
        }
        else {
            memcpy(ctx->block + ctx->block_ind, dataptr, 64 - ctx->block_ind);
            gostr3411_compress(ctx, ctx->block, 64 * 8);
            dataptr += (64 - ctx->block_ind);
            datalen -= (64 - ctx->block_ind);
        }
    }
    while (datalen >= 64) {
        gostr3411_compress(ctx, dataptr, 64 * 8);
        dataptr += 64;
        datalen -= 64;
    }
    memcpy(ctx->block, dataptr, datalen);
    ctx->block_ind = datalen;

cleanup:

    return ret;
}

int gostr3411_final(GostR3411Ctx *ctx, ByteArray** out)
{
    uint64_t tmp[8] = { 0 };
    size_t i;
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(out != NULL);

    ctx->block[ctx->block_ind] = 1;
    memset(ctx->block + ctx->block_ind + 1, 0, 64 - ctx->block_ind - 1);
    gostr3411_compress(ctx, ctx->block, ctx->block_ind * 8);

    G(ctx->state, ctx->total_length, tmp);
    G(ctx->state, ctx->sigma, tmp);

    if (ctx->variant == GOSTR3411_2012_VARIANT_256) {
        CHECK_NOT_NULL(*out = ba_alloc_by_len(32));
        for (i = 0; i < 4; i++) {
            LE_WRITE_UINT64((*out)->buf + i * 8, ctx->state[4 + i]);
        }
        memset(ctx->state, 1, 64);
    }
    else {
        CHECK_NOT_NULL(*out = ba_alloc_by_len(64));
        for (i = 0; i < 8; i++) {
            LE_WRITE_UINT64((*out)->buf + i * 8, ctx->state[i]);
        }
        memset(ctx->state, 0, 64);
    }

    memset(ctx->sigma, 0, 64);
    memset(ctx->total_length, 0, 64);
    memset(ctx->block, 0, 64);
    ctx->block_ind = 0;

cleanup:

    return ret;
}

size_t gostr3411_get_block_size(const GostR3411Ctx* ctx)
{
    (void)ctx;
    return 64;
}

void gostr3411_free(GostR3411Ctx* ctx)
{
    if (ctx) {
        secure_zero(ctx, sizeof(GostR3411Ctx));
        free(ctx);
    }
}

int gostr3411_self_test(void)
{
    //   34.11 - 2012.   ().  
    static const uint8_t M1[63] = {
        0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 
        0x36, 0x37, 0x38, 0x39, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x30, 0x31, 
        0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 
        0x38, 0x39, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x30, 0x31, 0x32 };
    static const uint8_t H512_M1[64] = {
        0x1B, 0x54, 0xD0, 0x1A, 0x4A, 0xF5, 0xB9, 0xD5, 0xCC, 0x3D, 0x86, 0xD6, 0x8D, 0x28, 0x54, 0x62, 
        0xB1, 0x9A, 0xBC, 0x24, 0x75, 0x22, 0x2F, 0x35, 0xC0, 0x85, 0x12, 0x2B, 0xE4, 0xBA, 0x1F, 0xFA,
        0x00, 0xAD, 0x30, 0xF8, 0x76, 0x7B, 0x3A, 0x82, 0x38, 0x4C, 0x65, 0x74, 0xF0, 0x24, 0xC3, 0x11,
        0xE2, 0xA4, 0x81, 0x33, 0x2B, 0x08, 0xEF, 0x7F, 0x41, 0x79, 0x78, 0x91, 0xC1, 0x64, 0x6F, 0x48 };
    static const uint8_t H256_M1[32] = {
        0x9D, 0x15, 0x1E, 0xEF, 0xD8, 0x59, 0x0B, 0x89, 0xDA, 0xA6, 0xBA, 0x6C, 0xB7, 0x4A, 0xF9, 0x27, 
        0x5D, 0xD0, 0x51, 0x02, 0x6B, 0xB1, 0x49, 0xA4, 0x52, 0xFD, 0x84, 0xE5, 0xE5, 0x7B, 0x55, 0x00 };
    static const uint8_t M2[72] = {
        0xD1, 0xE5, 0x20, 0xE2, 0xE5, 0xF2, 0xF0, 0xE8, 0x2C, 0x20, 0xD1, 0xF2, 0xF0, 0xE8, 0xE1, 0xEE, 
        0xE6, 0xE8, 0x20, 0xE2, 0xED, 0xF3, 0xF6, 0xE8, 0x2C, 0x20, 0xE2, 0xE5, 0xFE, 0xF2, 0xFA, 0x20, 
        0xF1, 0x20, 0xEC, 0xEE, 0xF0, 0xFF, 0x20, 0xF1, 0xF2, 0xF0, 0xE5, 0xEB, 0xE0, 0xEC, 0xE8, 0x20, 
        0xED, 0xE0, 0x20, 0xF5, 0xF0, 0xE0, 0xE1, 0xF0, 0xFB, 0xFF, 0x20, 0xEF, 0xEB, 0xFA, 0xEA, 0xFB, 
        0x20, 0xC8, 0xE3, 0xEE, 0xF0, 0xE5, 0xE2, 0xFB };
    static const uint8_t H512_M2[64] = {
        0x1E, 0x88, 0xE6, 0x22, 0x26, 0xBF, 0xCA, 0x6F, 0x99, 0x94, 0xF1, 0xF2, 0xD5, 0x15, 0x69, 0xE0, 
        0xDA, 0xF8, 0x47, 0x5A, 0x3B, 0x0F, 0xE6, 0x1A, 0x53, 0x00, 0xEE, 0xE4, 0x6D, 0x96, 0x13, 0x76, 
        0x03, 0x5F, 0xE8, 0x35, 0x49, 0xAD, 0xA2, 0xB8, 0x62, 0x0F, 0xCD, 0x7C, 0x49, 0x6C, 0xE5, 0xB3, 
        0x3F, 0x0C, 0xB9, 0xDD, 0xDC, 0x2B, 0x64, 0x60, 0x14, 0x3B, 0x03, 0xDA, 0xBA, 0xC9, 0xFB, 0x28 };
    static const uint8_t H256_M2[32] = {
        0x9D, 0xD2, 0xFE, 0x4E, 0x90, 0x40, 0x9E, 0x5D, 0xA8, 0x7F, 0x53, 0x97, 0x6D, 0x74, 0x05, 0xB0, 
        0xC0, 0xCA, 0xC6, 0x28, 0xFC, 0x66, 0x9A, 0x74, 0x1D, 0x50, 0x06, 0x3C, 0x55, 0x7E, 0x8F, 0x50 };
    static const ByteArray ba_M1 = { (uint8_t*)M1, sizeof(M1) };
    static const ByteArray ba_M2 = { (uint8_t*)M2, sizeof(M2) };

    int ret = RET_OK;
    GostR3411Ctx* ctx = NULL;
    ByteArray* H = NULL;

    CHECK_NOT_NULL(ctx = gostr3411_alloc(GOSTR3411_2012_VARIANT_512));
    DO(gostr3411_update(ctx, &ba_M1));
    DO(gostr3411_final(ctx, &H));
    if (H->len != sizeof(H512_M1) ||
        memcmp(H->buf, H512_M1, sizeof(H512_M1)) != 0) {
        SET_ERROR(RET_SELF_TEST_FAIL);
    }
    ba_free(H);
    H = NULL;

    DO(gostr3411_update(ctx, &ba_M2));
    DO(gostr3411_final(ctx, &H));
    if (H->len != sizeof(H512_M2) ||
        memcmp(H->buf, H512_M2, sizeof(H512_M2)) != 0) {
        SET_ERROR(RET_SELF_TEST_FAIL);
    }
    ba_free(H);
    H = NULL;
    gostr3411_free(ctx);
    
    CHECK_NOT_NULL(ctx = gostr3411_alloc(GOSTR3411_2012_VARIANT_256));
    DO(gostr3411_update(ctx, &ba_M1));
    DO(gostr3411_final(ctx, &H));
    if (H->len != sizeof(H256_M1) ||
        memcmp(H->buf, H256_M1, sizeof(H256_M1)) != 0) {
        SET_ERROR(RET_SELF_TEST_FAIL);
    }
    ba_free(H);
    H = NULL;

    DO(gostr3411_update(ctx, &ba_M2));
    DO(gostr3411_final(ctx, &H));
    if (H->len != sizeof(H256_M2) ||
        memcmp(H->buf, H256_M2, sizeof(H256_M2)) != 0) {
        SET_ERROR(RET_SELF_TEST_FAIL);
    }

cleanup:
    gostr3411_free(ctx);
    ba_free(H);
    return ret;
}
